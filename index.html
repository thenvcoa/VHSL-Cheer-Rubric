<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NVCOA Cheer Coaches Full Form + Rubric</title>
<style>
  body { font-family: Arial, sans-serif; margin: 30px; background: #fafafa; }
  h1 { color: #800000; }
  label { display: block; margin-top: 15px; font-weight: bold; }
  input, select, textarea { width: 90%; max-width: 600px; padding: 8px; margin-top: 5px; }
  button { margin-top: 25px; padding: 10px 16px; background: #800000; color: white; border: none; border-radius: 5px; cursor: pointer; }
  button:hover { background: #a00000; }
  .wrapper { position: relative; display: inline-block; margin-top: 20px; }
  #rubricImage { width: 90%; max-width: 950px; display: block; }
  .highlight { position: absolute; border: 2px solid transparent; background-color: transparent; pointer-events: none; }
  .twisting { border-color: rgba(255,0,0,0.8); background-color: rgba(255,0,0,0.25); }
  .coed     { border-color: rgba(0,0,255,0.8); background-color: rgba(0,0,255,0.25); }
  .release  { border-color: rgba(0,180,0,0.8); background-color: rgba(0,180,0,0.25); }
  .inversion{ border-color: rgba(180,0,180,0.8); background-color: rgba(180,0,180,0.25); }
  .toss     { border-color: rgba(255,120,0,0.8); background-color: rgba(255,120,0,0.25); }
  #output { margin-top: 20px; white-space: pre-wrap; background: #f7f7f7; padding: 10px; border-radius: 5px; max-width: 950px; }
  table { margin-top: 15px; border-collapse: collapse; width: 90%; max-width: 950px; }
  td, th { border: 1px solid #ccc; padding: 8px; vertical-align: middle; }
  th { background: #eee; }
  .drag-handle { cursor: move; margin-right: 8px; font-weight: bold; }
  .delete-btn { cursor: pointer; color: #c00; margin-left: 8px; font-size: 1.1em; }
  .instruction-text { margin-top: 15px; margin-bottom: 10px; font-size: 0.95em; }
  .hot-pink { color: hotpink; font-weight: bold; }
</style>
</head>
<body>

<h1>NVCOA Cheer Coaches Rubric + Full Form</h1>

<form id="fullForm" action="https://docs.google.com/forms/d/e/1FAIpQLSfQ3lyxpqbB0ej3RfpUok4s02UNwSfFExRDta7rATeTuqEg2g/formResponse" method="POST" target="hidden_iframe">

  <!-- Google Form Fields -->
  <label>School Name</label>
  <input type="text" id="schoolName">

  <label>Team Level</label>
  <select id="teamLevel">
    <option value="">--Select--</option>
    <option value="Varsity">Varsity</option>
    <option value="Junior Varsity">Junior Varsity</option>
  </select>

  <label>Number of Athletes Performing</label>
  <input type="number" id="numAthletes" min="1">

  <label>Competition Location</label>
  <input type="text" id="competitionLocation">

  <label>Competition Date</label>
  <input type="date" id="competitionDate">

  <label>Intended Stunt Range</label>
  <select id="stuntRange">
    <option value="">--Select--</option>
    <option>Beginner: 0.0 - 1.0</option>
    <option>Intermediate: 1.25 - 3.25</option>
    <option>Advanced: 3.5 - 5.5</option>
    <option>Elite: 5.75 - 7.75</option>
    <option>Super Elite: 8.0 - 10.0</option>
  </select>

  <h2>Stunt Skills Rubric</h2>
  <p>Click on the rubric image to select skills.</p>
  <div class="wrapper">
    <img id="rubricImage" src="Stunt_Rubric.png" alt="VHSL Rubric">

    <!-- Highlight boxes (example) -->
    <div class="highlight inversion" id="i1" style="left:62px; top:131px; width:146px; height:17px;"></div>
    <div class="highlight release" id="r1" style="left:62px; top:217px; width:146px; height:15px;"></div>
    <div class="highlight twisting" id="t1" style="left:62px; top:335px; width:146px; height:7px;"></div>
    <div class="highlight coed" id="c1" style="left:62px; top:410px; width:146px; height:14px;"></div>
    <div class="highlight toss" id="o1" style="left:62px; top:555px; width:146px; height:15px;"></div>
  </div>

  <div class="instruction-text">
    Enter the number of groups for each skill. <span class="hot-pink">Please list skills in order of performance.</span> Use the <span>‚áÖ</span> to reorder or the <span>üóëÔ∏è</span> to delete.
  </div>

  <table id="skillCountsTable">
    <thead>
      <tr><th>Skill</th><th>Groups</th></tr>
    </thead>
    <tbody id="skillCounts"></tbody>
  </table>

  <label>Intended Pyramid Range</label>
  <select id="pyramidRange">
    <option value="">--Select--</option>
    <option>Beginner: 0.0 - 1.0</option>
    <option>Intermediate: 1.25 - 3.25</option>
    <option>Advanced: 3.5 - 5.5</option>
    <option>Elite: 5.75 - 7.75</option>
    <option>Super Elite: 8.0 - 10.0</option>
  </select>

  <label>Pyramid Skills Description</label>
  <textarea id="pyramidSkills" rows="3"></textarea>

  <label>Intended Tumbling Range</label>
  <select id="tumblingRange">
    <option value="">--Select--</option>
    <option>0.0 - 1.0</option>
    <option>1.25 - 2.5</option>
    <option>2.75 - 4.0</option>
    <option>4.25 - 5.0</option>
  </select>

  <label>Team Majority Sync Sequence Description</label>
  <textarea id="teamSync" rows="3"></textarea>

  <label>Additional Tumbling Skills Description</label>
  <textarea id="additionalTumbling" rows="3"></textarea>

  <label>Intended Jump Range</label>
  <select id="jumpRange">
    <option value="">--Select--</option>
    <option>0.0 - 1.5</option>
    <option>1.75 - 2.75</option>
    <option>3.0 - 4.0</option>
    <option>4.25 - 4.75</option>
    <option>5.0</option>
  </select>

  <label>Jump Sequence Description</label>
  <textarea id="jumpSequence" rows="3"></textarea>

  <label>Any Legality Rulings from Bill Ahern?</label>
  <select id="legalityRulings">
    <option value="">--Select--</option>
    <option>Yes</option>
    <option>No</option>
  </select>

  <!-- Hidden Google Form Fields -->
  <textarea name="entry.853885754" id="gStuntSkills" style="display:none;"></textarea>
  <input type="hidden" name="entry.1305398481" id="gSchoolName">
  <input type="hidden" name="entry.1115196285" id="gTeamLevel">
  <input type="hidden" name="entry.1591826976" id="gNumAthletes">
  <input type="hidden" name="entry.213144247" id="gLocation">
  <input type="hidden" name="entry.350592538" id="gDate">
  <input type="hidden" name="entry.839382260" id="gStuntRange">
  <input type="hidden" name="entry.1261324678" id="gPyramidRange">
  <input type="hidden" name="entry.1334475235" id="gPyramidSkills">
  <input type="hidden" name="entry.1257575335" id="gTumblingRange">
  <input type="hidden" name="entry.1061923490" id="gTeamSync">
  <input type="hidden" name="entry.366964955" id="gAdditionalTumbling">
  <input type="hidden" name="entry.1517156909" id="gJumpRange">
  <input type="hidden" name="entry.1736401588" id="gJumpSequence">
  <input type="hidden" name="entry.815911308" id="gLegalityRulings">

  <div style="text-align: center; margin-top: 30px;">
    <button type="button" id="saveBtn" style="padding: 12px 20px; font-size: 16px;">Save & Submit</button>
  </div>

</form>

<pre id="output"></pre>
<iframe name="hidden_iframe" style="display:none;"></iframe>

<script>
const regions = [
  { id: 'i1', skill: 'Connected Inversions', category: 'Inversion' },
  { id: 'r1', skill: 'Release to Below Prep', category: 'Release' },
  { id: 't1', skill: '1/4 or 1/2 Up to Prep Level', category: 'Twisting' },
  { id: 'c1', skill: 'Single Base at Prep Level', category: 'Coed' },
  { id: 'o1', skill: 'Prep Level and Below Stunts', category: 'Toss' }
];

const wrapper = document.querySelector('.wrapper');
const skillCountsContainer = document.getElementById('skillCounts');

wrapper.addEventListener('click', e => {
  const rect = wrapper.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;

  for (let r of regions) {
    const box = document.getElementById(r.id);
    const left = parseFloat(box.style.left);
    const top = parseFloat(box.style.top);
    const width = parseFloat(box.style.width);
    const height = parseFloat(box.style.height);

    if (x >= left && x <= left + width && y >= top && y <= top + height) {
      // Blink effect
      box.style.opacity = '0.25';
      setTimeout(() => box.style.opacity = '1', 150);

      // Add a new row for every click
      const row = document.createElement('tr');
      row.innerHTML = `<td><span class="drag-handle">‚áÖ</span>${r.skill}</td>
                       <td><input type="number" min="0" value="0"></td>
                       <td><span class="delete-btn">üóëÔ∏è</span></td>`;
      skillCountsContainer.appendChild(row);

      // Delete button
      row.querySelector('.delete-btn').addEventListener('click', () => {
        row.remove();
      });

      break;
    }
  }
});

// Drag & drop rows
let dragSrcEl = null;
function handleDragStart(e) {
  dragSrcEl = this;
  e.dataTransfer.effectAllowed = 'move';
  e.dataTransfer.setData('text/html', this.innerHTML);
}
function handleDragOver(e) {
  if (e.preventDefault) e.preventDefault();
  e.dataTransfer.dropEffect = 'move';
  return false;
}
function handleDrop(e) {
  if (e.stopPropagation) e.stopPropagation();
  if (dragSrcEl !== this) {
    dragSrcEl.innerHTML = this.innerHTML;
    this.innerHTML = e.dataTransfer.getData('text/html');

    addDeleteHandlers(dragSrcEl);
    addDeleteHandlers(this);
    addDragHandlers(dragSrcEl);
    addDragHandlers(this);
  }
  return false;
}
function addDragHandlers(row) {
  row.addEventListener('dragstart', handleDragStart);
  row.addEventListener('dragover', handleDragOver);
  row.addEventListener('drop', handleDrop);
}
function addDeleteHandlers(row) {
  const delBtn = row.querySelector('.delete-btn');
  if (delBtn) delBtn.addEventListener('click', () => row.remove());
}
new MutationObserver(mutations => {
  mutations.forEach(m => {
    m.addedNodes.forEach(node => {
      if (node.tagName === 'TR') {
        node.setAttribute('draggable', 'true');
        addDragHandlers(node);
        addDeleteHandlers(node);
      }
    });
  });
}).observe(skillCountsContainer, { childList: true });

// Save & submit
document.getElementById('saveBtn').addEventListener('click', () => {
  let out = 'Selected VHSL Stunt Rubric Skills:\n\n';
  const rows = skillCountsContainer.querySelectorAll('tr');
  if (rows.length === 0) out += '(None selected)';
  else rows.forEach(row => {
    const skill = row.cells[0].textContent.replace('‚áÖ','').trim();
    const count = row.querySelector('input').value;
    out += `${count} ‚Äî ${skill}\n`;
  });

  document.getElementById('output').textContent = out;

  // Populate hidden fields
  document.getElementById('gStuntSkills').value = out;
  document.getElementById('gSchoolName').value = document.getElementById('schoolName').value;
  document.getElementById('gTeamLevel').value = document.getElementById('teamLevel').value;
  document.getElementById('gNumAthletes').value = document.getElementById('numAthletes').value;
  document.getElementById('gLocation').value = document.getElementById('competitionLocation').value;
  document.getElementById('gDate').value = document.getElementById('competitionDate').value;
  document.getElementById('gStuntRange').value = document.getElementById('stuntRange').value;
  document.getElementById('gPyramidRange').value = document.getElementById('pyramidRange').value;
  document.getElementById('gPyramidSkills').value = document.getElementById('pyramidSkills').value;
  document.getElementById('gTumblingRange').value = document.getElementById('tumblingRange').value;
  document.getElementById('gTeamSync').value = document.getElementById('teamSync').value;
  document.getElementById('gAdditionalTumbling').value = document.getElementById('additionalTumbling').value;
  document.getElementById('gJumpRange').value = document.getElementById('jumpRange').value;
  document.getElementById('gJumpSequence').value = document.getElementById('jumpSequence').value;
  document.getElementById('gLegalityRulings').value = document.getElementById('legalityRulings').value;

  document.getElementById('fullForm').submit();
  alert('Form submitted! You may now close this page.');
});
</script>

</body>
</html>
