
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>VHSL Cheer Coaches Rubric Submission</title>

<!-- ========================GENERAL STYLE COMMANDS======================== -->
<style>
/* === GENERAL STYLING === */
  body { font-family: Arial, sans-serif; margin: 30px; background: #fafafa; }
  h1 { color: #2F317D; font-size: 40px; font-weight: 700; }
  label { display: block; margin-top: 15px; font-weight: bold; }
  input, select, textarea { width: 90%; max-width: 600px; padding: 8px; margin-top: 5px; }
  .highlight-bar {    background-color: #F8DF00;  padding: 6px 6px; border-radius: 6px; display: inline-block;}   
  button { margin-top: 25px; padding: 10px 16px; background: #2F317D; color: white; border: none; border-radius: 5px; cursor: pointer; }
  button:hover { background: #c02025; }
  .reset-button {  background-color: #c02025 !important;  color: white !important;}
  .reset-button:hover {  background-color: #D1BC00 !important;}
  hr { border: none; 	height: 4px; 	background-color: #2F317D; 	margin: 30px 0; }
  .center-text { text-align: center;}
  a { color: #2F317D;  text-decoration: underline; }
  a:hover { color: #c02025; }
  input::placeholder, textarea::placeholder {  font-style: italic; color: #CFCFCE; white-space: pre-line;}
  textarea { font-family: Arial, sans-serif;}
  .section-card {  background: #ffffff;  border-radius: 16px;  padding: 25px 30px;  
      margin: 40px auto;  box-shadow: 0 4px 12px rgba(0,0,0,0.08);  max-width: 1100px;}


/* === STUNT & PYRAMID === */
  .wrapper {    width: fit-content;  margin-left: auto; margin-right: auto;  position: relative; 	margin-bottom: 40px; cursor: pointer;}
  .wrapper img {  display: block; }
  #output, #outputp { margin-top: 20px; white-space: pre-wrap; background: #f7f7f7; padding: 10px; border-radius: 5px; max-width: 825px; }
  table { width: 70%; max-width: 950px; border-collapse: collapse; margin-top: 10px; }
  th, td { padding: 6px 10px; text-align: left; border-bottom: 1px solid #ccc; }
  th { background: #f0f0f0; }
  #skillCountsTable th:nth-child(3), #skillCountsTable td:nth-child(3) { width: 80px; min-width: 80px; max-width: 80px; text-align: center; }
  #PyramidCountsTable th:nth-child(3), #PyramidCountsTable td:nth-child(3) { width: 80px; min-width: 80px; max-width: 80px; text-align: center; }
  #skillCounts input, #PyramidCounts input { width: 60px; }
  .drag-handle { cursor: grab; font-size: 18px; }
  .delete-btn { cursor: pointer; color: #d00; font-size: 18px; text-align: center; }
  .text-underline {  color: #c02025;  text-decoration: underline;  }
  .note-small { font-size: 12px; font-style: italic; color: gray; margin-top: 26px; }
  .icon {  font-size: 24px;       vertical-align: middle;   }
  .majority { background-color: rgba(0, 200, 0, 0.2);  }
  .non-majority {  background-color: rgba(255, 0, 0, 0.2);  }
  
/* === JUMP & TUMBLING === */
  .jumphighlight.selected,  .tumblinghighlight.selected  {    outline: 3px solid #c02025;    background-color: rgba(192, 32, 37, 0.15);}
  .jumphighlight,   .tumblinghighlight{    position: absolute;    cursor: pointer;}
  
/* === LOADING SPINNER === */  
  #loadingOverlay {  position: fixed;  top: 0; left: 0;  width: 100%; height: 100%;  background: rgba(0, 0, 0, 0.65);  display: none;
	align-items: center;  flex-direction: column;  justify-content: center;  z-index: 99999; opacity: 1;  transition: opacity 0.6s ease;}
  #loadingOverlay.fade-out {  opacity: 0;}
  .spinner {  width: 70px;  height: 70px;  border: 7px solid #ffffff55;  border-top: 7px solid #F8DF00;  border-radius: 50%;  animation: spin 1s linear infinite;}
  @keyframes spin {  0% { transform: rotate(0deg); }  100% { transform: rotate(360deg); }} 
  
/* === ALERT MESSAGES === */  
  #customAlert { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5);
                 display: flex; justify-content: center; align-items: center; z-index: 9999;}
  #customAlertContent {background: #fff; padding: 20px 25px; border-radius: 8px;
                       max-width: 400px; text-align: center; box-shadow: 0 4px 10px rgba(0,0,0,0.3);}
  #customAlertContent button { margin-top: 15px; padding: 8px 16px; background: #2F317D; color: white;
                               border: none; border-radius: 5px; cursor: pointer;}
  #customAlertContent button:hover {  background: #c02025;}
  #customAlertText {  white-space: pre-line;}
  
/* === DARK MODE ADJUSTMENTS FOR MOBILE === */
@media (prefers-color-scheme: dark) {
  body { background: #1a1a1a !important; color: #f2f2f2 !important; }
  input, select, textarea { background: #2a2a2a !important; color: #ffffff !important; border: 1px solid #444 !important; }
  #output,  #outputp,  #StuntSkills,  #StuntRange,  #PyramidSkills,  #PyramidRange 
	{ background: #2a2a2a !important; color: #ffffff !important; border: 1px solid #444 !important; border-radius: 5px !important; padding: 10px !important; }
  tr.majority td { background-color: rgba(167,235,167, 0.2) !important; color: #ffffff !important; }
  tr.non-majority td { background-color: rgba(249,173,173, 0.2) !important; color: #ffffff !important; }
  table, th, td { background: #1f1f1f !important; color: #f2f2f2 !important; border-color: #444 !important; }
  th { background: #333 !important; }
  .highlight-bar { background-color: #F8DF00 !important;  color: #000000 !important;  border-radius: 6px; }
  button { background: #2F317D !important; color: white !important; }
  button:hover { background: #c02025 !important; }
  input[style*="red"],  select[style*="red"],  textarea[style*="red"] { border: 2px solid red !important; background-color: #2a2a2a !important; color: #ffffff !important; }
  #customAlertContent { background: #2a2a2a !important; color: #ffffff !important; border: 1px solid #555 !important; }
  .section-card {    background: #262626 !important;     color: #f2f2f2 !important;    box-shadow: 0 4px 14px rgba(0,0,0,0.55) !important;    border: 1px solid #333 !important;  }
  .section-card h2 {    color: #ffffff !important;  }
  .section-card p,  .section-card label {    color: #e6e6e6 !important;  }
  }
</style>

<!-- =================== RESPONSIVE INLINE SVG FOR STUNT & PYRAMID RUBRIC =================== -->
<style>
/* SVG highlight styling */
  .svg-highlight {  fill: none;  stroke: none;  outline: none;    pointer-events: all;  }
  .svg-highlight.inversion  { stroke: none; fill: none; }
  .svg-highlight.release    { stroke: none; fill: none; }
  .svg-highlight.twisting   { stroke: none; fill: none; }
  .svg-highlight.coed       { stroke: none; fill: none; }
  .svg-highlight.toss       { stroke: none; fill: none; }

/* Highlight appearance during flash */
  .svg-flash.inversion  { stroke: rgba(180,0,180,0.85); fill: rgba(180,0,180,0.18); stroke-width: 3; }
  .svg-flash.release    { stroke: rgba(0,180,0,0.85);   fill: rgba(0,180,0,0.18); stroke-width: 3;   }
  .svg-flash.twisting   { stroke: rgba(255,0,0,0.85);   fill: rgba(255,0,0,0.18); stroke-width: 3;   }
  .svg-flash.coed       { stroke: rgba(0,0,255,0.85);   fill: rgba(0,0,255,0.12); stroke-width: 3;   }
  .svg-flash.toss       { stroke: rgba(255,120,0,0.85); fill: rgba(255,120,0,0.12); stroke-width: 3; }

/*Fade out effect*/
  .svg-highlight.fadeout {  fill: none !important;  stroke: none !important;}

/* ensure the svg scales nicely inside existing .wrapper */
  .svg-wrapper { width: 90%; max-width: 950px; margin: 0 auto; display: block; }
  .svg-wrapper svg { width: 100%; height: auto; display: block; }

/* keep pointer cursor for clickable regions */
 .svg-highlight { cursor: pointer; }
</style>

<!-- =================== EXTRA VISUAL ADD-ONS =================== -->
<style>

/* Green Checkmark After Completed Field */
  input.completed, select.completed, textarea.completed {
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="%2300A000" viewBox="0 0 16 16"><path d="M6.003 11.803L2.2 8l1.4-1.4 2.4 2.4 5.4-5.4L12.8 5l-6.8 6.8z"/></svg>');
    background-repeat: no-repeat;  background-position: right 10px center;  background-size: 18px;  padding-right: 35px;}
/* Info Pop Up Box */  
  .info-icon {  cursor: pointer;  font-size: 18px;  margin-left: 6px;  color: #2F317D;}
  .info-icon:hover {  color: #c02025;}
  .info-popup {  display: none;  position: fixed;  top: 50%; left: 50%;  transform: translate(-50%, -50%);  background: white; padding: 20px 25px;  
               border-radius: 10px;  box-shadow: 0 6px 20px rgba(0,0,0,0.25);  z-index: 10000;  max-width: 400px;  text-align: left;   text-align: center;}
  .info-popup a {  color: #2F317D;  text-decoration: underline;}
  .info-icon:active::after {  content: attr(data-tooltip);} /* Mobile/touch support */
/* Successful Submission Confetti */
#confettiContainer {  position: fixed;  pointer-events: none;  top: 0;  left: 0;  width: 100%;
     height: 100%;  overflow: hidden;  z-index: 999999;  display: none;}
.confetti-piece {  position: absolute;  width: 8px;  height: 8px;  opacity: 0.85;
     border-radius: 2px;  animation: confetti-fall 7.0s ease-out forwards;}
@keyframes confetti-fall {  0%   { transform: translateY(0) rotate(0deg); opacity: 1; }
     100% { transform: translateY(450vh) rotate(250deg); opacity: 0; } }
</style>

<!-- =================== DEBUG MODE =================== -->
<style>
/* ===================================================
   (Comment this whole block out when not in use)
=================================================== */
  .svg-highlight.inversion {  stroke: rgba(180,0,180,0.85) !important;  fill: rgba(180,0,180,0.18) !important;  stroke-width: 3px !important;}
  .svg-highlight.release {  stroke: rgba(0,180,0,0.85) !important;  fill: rgba(0,180,0,0.18) !important;  stroke-width: 3px !important;}
  .svg-highlight.twisting {  stroke: rgba(255,0,0,0.85) !important;  fill: rgba(255,0,0,0.18) !important;  stroke-width: 3px !important;}
  .svg-highlight.coed {  stroke: rgba(0,0,255,0.85) !important;  fill: rgba(0,0,255,0.12) !important;  stroke-width: 3px !important;}
  .svg-highlight.toss {  stroke: rgba(255,120,0,0.85) !important;  fill: rgba(255,120,0,0.12) !important;  stroke-width: 3px !important;}
</style>




</head>
<body>

<!-- ========================START HTML VISUAL======================== -->

	<div style="text-align: center; margin-bottom: 20px;">
		<img src="vhsl_logo.png" alt="VHSL Logo" style="max-width: 250px; height: auto;">
	</div>

	<div style="text-align: center; margin-bottom: 40px;">
		<h1>VHSL Cheer Coaches Rubric Submission</h1>
	</div>

<div class="center-text">
<p>
  For additional resources, visit 
  <a href="https://www.vhsl.org/competition-cheer/" target="_blank" rel="noopener noreferrer">
    VHSL Cheer Website</a>.
</p>
</div>

<hr>

<div class="center-text">
 <p class="highlight-bar">All fields are required.</p>
</div>

<div class="section-card" data-section="CoachTeamInfo">
  <label>School Name</label>
  <input type="text" id="schoolName">

  <label>Team Level</label>
  <select id="teamLevel">
    <option value="">--Select--</option>
    <option value="Varsity">Varsity</option>
    <option value="Junior Varsity">Junior Varsity</option>
	<option value="Middle School">Middle School</option>
  </select>

  <label>Head Coach First & Last Name</label>
  <input type="text" id="CoachName">
 
   <label>Head Coach Email</label>
  <input type="text" id="CoachEmail" placeholder="myname@gmail.com">

  <label>Number of Athletes Performing</label>
  <input type="number" id="numAthletes" min="1">


<label>Competition Date & Location</label>
<select id="competitionLocation">
  <option value="">--Select--</option>
</select>
</div>

<hr>

<div class="section-card" data-section="Stunts">
<div class="center-text">  
  <h2>Stunt Skills Rubric 
  <span class="info-icon" onclick="showInfo('majorityInfo')">‚ìò</span>
  </h2>

  <p><strong>Click on the rubric image to select skills.</strong></p>
</div>


	
  <div class="wrapper svg-wrapper" aria-label="Stunt Rubric (interactive)">
  <!-- Outer SVG (viewBox matches the original SVG canvas: 0 0 928 705) -->
  <svg id="StuntRubricSVG" viewBox="0 0 928 705" preserveAspectRatio="xMidYMid meet" role="img" aria-label="VHSL Stunt Rubric">
    <!-- Use your uploaded SVG file as the background image inside the inline SVG -->
    <!-- Keep the filename exactly as you host it. If you inlined the whole SVG body instead, remove this <image> line. -->
    <image href="Stunt Rubric 2026.svg" x="0" y="0" width="928" height="705" preserveAspectRatio="xMidYMid meet" />

    <!-- Responsive region overlays.
         Coordinates are percentages (x, y, width, height) so they scale with the SVG.
         IDs match original HTML so your JS mapping still applies.
         These rects were computed from your PNG coords and corrected for the SVG's internal translate.
    -->

    <!-- Inversions -->
    <rect id="i1" class="svg-highlight inversion" x="7.25%" y="18.5%" width="17.75%" height="3%"></rect>
    <rect id="i2" class="svg-highlight inversion" x="7.25%" y="21.25%" width="17.75%" height="3.5%"></rect>
    <rect id="i3" class="svg-highlight inversion" x="7.25%" y="24.75%" width="17.75%" height="3%"></rect>
    <rect id="i4" class="svg-highlight inversion" x="25.25%" y="18.5%" width="17.5%" height="3%"></rect>
	<rect id="i5" class="svg-highlight inversion" x="25.25%" y="21.25%" width="17.5%" height="3.5%"></rect>
	<rect id="i6" class="svg-highlight inversion" x="25.25%" y="24.75%" width="17.5%" height="3%"></rect>
	<rect id="i7" class="svg-highlight inversion" x="42.75%" y="18.5%" width="18.25%" height="3%"></rect>
	<rect id="i8" class="svg-highlight inversion" x="42.75%" y="24.75%" width="18.25%" height="3%"></rect>
	
	<rect id="i9" class="svg-highlight inversion" x="61%" y="18.5%" width="18.5%" height="3%"></rect>
	<rect id="i10" class="svg-highlight inversion" x="61%" y="24.75%" width="18.5%" height="3%"></rect>
	<rect id="i11" class="svg-highlight inversion" x="61%" y="27.75%" width="18.5%" height="3%"></rect>
	<rect id="i12" class="svg-highlight inversion" x="79.75%" y="24.75%" width="18.25%" height="3%"></rect>
	<rect id="i13" class="svg-highlight inversion" x="79.75%" y="27.75%" width="18.25%" height="3%"></rect>

    <!-- Releases -->
    <rect id="r1" class="svg-highlight release" x="7.25%" y="32%" width="17.75%" height="2.5%"></rect>
    <rect id="r2" class="svg-highlight release" x="7.25%" y="34.5%" width="17.75%" height="2%"></rect>
    <rect id="r3" class="svg-highlight release" x="7.25%" y="36.5%" width="17.75%" height="2.5%"></rect>

    <!-- Twisting -->
    <rect id="t1" class="svg-highlight twisting" x="7.25%" y="52.5%" width="17.75%" height="2%"></rect>
    <rect id="t2" class="svg-highlight twisting" x="7.25%" y="54.75%" width="17.75%" height="2%"></rect>
    <rect id="t3" class="svg-highlight twisting" x="7.25%" y="57%" width="17.75%" height="2.5%"></rect>

    <!-- Coed -->
    <rect id="c1" class="svg-highlight coed" x="7.25%" y="65%" width="17.75%" height="2.25%"></rect>
    <rect id="c2" class="svg-highlight coed" x="7.25%" y="71.5%" width="17.75%" height="2.5%"></rect>
    <rect id="c3" class="svg-highlight coed" x="7.25%" y="74%" width="17.75%" height="2.5%"></rect>

    <!-- Toss -->
    <rect id="o1" class="svg-highlight toss" x="7.25%" y="84.25%" width="17.75%" height="2.75%"></rect>
    <rect id="o2" class="svg-highlight toss" x="7.25%" y="88.25%" width="17.75%" height="4%"></rect>
    <rect id="o3" class="svg-highlight toss" x="25.25%" y="84.25%" width="17.5%" height="2.75%"></rect>
	<rect id="o4" class="svg-highlight toss" x="25.25%" y="88.25%" width="17.5%" height="4%"></rect>
	<rect id="o5" class="svg-highlight toss" x="42.75%" y="88.25%" width="18.25%" height="4%"></rect>
	<rect id="o6" class="svg-highlight toss" x="61.25%" y="88.25%" width="18.25%" height="4%"></rect>
	<rect id="o7" class="svg-highlight toss" x="79.75%" y="88.25%" width="18.5%" height="4%"></rect>

    <!-- Bottom header/test boxes -->
    <rect id="h1" class="svg-highlight inversion" x="20%" y="80%" width="20%" height="3%"></rect>
    <rect id="h2" class="svg-highlight release"   x="45%" y="80%" width="20%" height="3%"></rect>
    <rect id="h3" class="svg-highlight twisting"  x="70%" y="80%" width="20%" height="3%"></rect>
  </svg>
  </div>
	
	
	
	

	<p><strong>
	Enter the number of stunt groups for each skill.
	<span class="text-underline">Please list skills in order of performance.</span> 
	</strong></p>

	<!-- Drag & drop table -->
	<table id="skillCountsTable">
		<thead>
		<tr>
			<th>Skill</th>
			<th>Difficulty</th>
			<th># of Stunt Groups</th>
			<th style="width:30px;">üóëÔ∏è</th>
		</tr>
		</thead>
		<tbody id="skillCounts"></tbody>
	</table>

	<div style="display: flex; align-items: center; gap: 10px;">
	<button onclick="runChecker()">Calculate Stunt Difficulty Range</button>
    <span class="note-small">
        Majority skills will highlight in green and non-majority skills will highlight in red.
    </span>
	</div>

	<div id="output"></div>
</div>

<hr>

<div class="section-card" data-section="Pyramid">
 <div class="center-text">
  <h2>Pyramid Skills Rubric
  <span class="info-icon" onclick="showInfo('majorityInfo')">‚ìò</span>
  </h2>
  <p><strong>Click on the rubric image to select skills.</strong></p>
</div>


  <!-- ======= RESPONSIVE INLINE SVG: PYRAMID RUBRIC ======= -->
  <div class="wrapper svg-wrapper" aria-label="Pyramid Rubric (interactive)">
  <svg id="PyramidRubricSVG" viewBox="0 0 1174 643" preserveAspectRatio="xMidYMid meet" role="img" aria-label="VHSL Pyramid Rubric">
    <!-- Use your uploaded SVG file as the background image inside the inline SVG -->
    <!-- Keep the filename exactly as you host it. If you inlined the whole SVG body instead, remove this <image> line. -->
    <image href="Pyramid Rubric 2026.svg" x="0" y="0" width="1174" height="643" preserveAspectRatio="xMidYMid meet" />

    <!-- Highlight regions (same pattern as Stunt) -->
    <rect id="n1" class="svg-highlight inversion"  x="18.5%" y="16.75%" width="15%" height="5%"></rect>
    <rect id="n2" class="svg-highlight inversion"  x="18.5%" y="21.75%" width="15%" height="6.25%"></rect>
    <rect id="n3" class="svg-highlight inversion"  x="18.5%" y="33.75%" width="15%" height="5.25%"></rect>
    <rect id="n4" class="svg-highlight inversion"  x="33.5%" y="16.75%" width="15.25%" height="5%"></rect>

    <rect id="pr1" class="svg-highlight release"    x="18.5%" y="47.25%" width="15%" height="6.5%"></rect>
    <rect id="pr2" class="svg-highlight release"    x="18.5%" y="53.75%" width="15%" height="6.5%"></rect>
    <rect id="pr3" class="svg-highlight release"    x="33.75%" y="47.25%" width="15%" height="6.5%"></rect>

    <rect id="b1" class="svg-highlight twisting"   x="18.5%" y="74.75%" width="15%" height="4.5%"></rect>
    <rect id="b2" class="svg-highlight twisting"   x="18.5%" y="79.5%" width="15%" height="6.25%"></rect>
    <rect id="b3" class="svg-highlight twisting"   x="18.5%" y="85.75%" width="15%" height="8.5%"></rect>

  </svg>
  </div>

	<p><strong>
	Enter the number of trick flyers for each skill. 
	<span class="text-underline">Please list skills in order of performance.</span> 
	</strong></p>

	<!-- Drag & drop table -->
	<table id="PyramidCountsTable">
		<thead>
		<tr>
			<th>Skill</th>
			<th>Difficulty</th>
			<th># of Trick Flyers</th>
			<th style="width:30px;">üóëÔ∏è</th>
		</tr>
		</thead>
		<tbody id="PyramidCounts"></tbody>
	</table>

	<div style="display: flex; align-items: center; gap: 10px;">
	<button onclick="runChecker2()">Calculate Pyramid Difficulty Range</button>
	<span class="note-small">
		Majority skills will highlight in green and non-majority skills will highlight in red.
	</span>
	</div>

	<div id="outputp"></div>
  </div>
  
<hr>

<div class="section-card" data-section="Tumbling">
<div class="center-text">
  <h2>Tumbling Skills Rubric
  <span class="info-icon" onclick="showInfo('majorityInfo')">‚ìò</span>
  </h2>
  <p><strong>Click on the rubric image to select skills.</strong></p>
</div>

	<div class="wrapper">
		<img id="TumblingRubricImage" src="Tumbling_Rubric.png" alt="Tumbling Rubric">

		<!-- Highlight boxes (clickable areas) -->
		<!-- Row 1: 0.0 ‚Äì 1.0 -->
		<div class="tumblinghighlight tumbling" id="tumbling1" 
			style="left:7px; top:100px; width:595px; height:103px;" 
			data-value="0.0 ‚Äì 1.0"></div>

		<!-- Row 2: 1.25 ‚Äì 2.5 -->
		<div class="tumblinghighlight tumbling" id="tumbling2" 
			style="left:7px; top:205px; width:595px; height:83px;" 
			data-value="1.25 ‚Äì 2.5"></div>

		<!-- Row 3: 2.75 ‚Äì 4.00 -->
		<div class="tumblinghighlight tumbling" id="tumbling3" 
			style="left:7px; top:290px; width:595px; height:67px;" 
			data-value="2.75 ‚Äì 4.00"></div>

		<!-- Row 4: 4.25 ‚Äì 5.0 -->
		<div class="tumblinghighlight tumbling" id="tumbling4" 
			style="left:7px; top:359px; width:595px; height:92px;" 
			data-value="4.25 ‚Äì 5.0"></div>

	</div>

	<div id="TumblingOutput" style="margin-top:15px; font-size:1.2em; font-weight:bold;">
		Tumbling Difficulty Range: None
	</div>


  <label>Team Majority Sync Sequence Description</label>
  <textarea id="teamSync" rows="4" placeholder="Please note the number of athletes and any ripples.
  
  Example:
  9 roundoff backhandsprings - rippled in 3 groups of 3"></textarea>

  <label>Additional Tumbling Skills Description</label>
  <textarea id="additionalTumbling" rows="9" placeholder="Please list any additional tumbling skills in the order of performance.

	Example:
	2 cartwheels
	3 round offs
	1 aerial
	4 round off backhandspring tucks
	1 roundoff layout
	8 forward rolls"></textarea>
	</div>

<hr>

<div class="section-card" data-section="Jumps">
<div class="center-text">
  <h2>Jump Skills Rubric
  <span class="info-icon" onclick="showInfo('majorityInfo')">‚ìò</span>
  </h2>
  <p><strong>Click on the rubric image to select skills.</strong></p>
</div>

	<div class="wrapper">
		<img id="JumpRubricImage" src="Jump_Rubric.png" alt="Jump Rubric">

		<!-- Highlight boxes (clickable areas) -->
		<!-- Row 1: 0.0 ‚Äì 1.5 -->
		<div class="jumphighlight jump" id="jump1" 
			style="left:10px; top:100px; width:440px; height:70px;" 
			data-value="0.0 ‚Äì 1.5"></div>

		<!-- Row 2: 1.75 ‚Äì 2.75 -->
		<div class="jumphighlight jump" id="jump2" 
			style="left:10px; top:172px; width:440px; height:55px;" 
			data-value="1.75 ‚Äì 2.75"></div>

		<!-- Row 3: 3.00 ‚Äì 4.00 -->
		<div class="jumphighlight jump" id="jump3" 
			style="left:10px; top:231px; width:440px; height:103px;" 
			data-value="3.00 ‚Äì 4.00"></div>

		<!-- Row 4: 4.25 ‚Äì 4.75 -->
		<div class="jumphighlight jump" id="jump4" 
			style="left:10px; top:338px; width:440px; height:41px;" 
			data-value="4.25 ‚Äì 4.75"></div>

		<!-- Row 5: 5.0 -->
		<div class="jumphighlight jump" id="jump5" 
			style="left:10px; top:383px; width:440px; height:55px;" 
			data-value="5.0"></div>
	</div>

	<div id="JumpOutput" style="margin-top:15px; font-size:1.2em; font-weight:bold;">
		Jump Difficulty Range: None
	</div>


  <label>Jump Sequence Description</label>
  <textarea id="jumpSequence" rows="5" placeholder="Please describe your jump sequence in detail.

	Example:
	11 right hurdlers (in cheer)
	11 double toe touches"></textarea>
</div>

<hr>

<div class="section-card" data-section="Legality">
  <label>Any Legality Rulings from Bill Ahern?</label>
  <select id="legalityRulings">
    <option value="">--Select--</option>
    <option>Yes</option>
    <option>No</option>
  </select>
</div>

  <div style="text-align: center; margin-top: 30px;">
    <button type="button" id="saveBtn" style="padding: 16px 28px; font-size: 20px;">Save & Submit</button>
	<br>
	<br>
	<button id="resetBtn" class="reset-button" onclick="localStorage.removeItem('rubricFormAutosave'); location.reload();">Clear  |  Reset </button>
    <button id="previewBtn" style="background:#555;">Preview  |  Print</button>



  </div>


<!-- Summary Output Results -->

<div id="SummaryWrapper" style="display:none;">
<label>Stunt Skills Summary</label>
<div id="StuntSkills" style="white-space: pre-wrap; background: #f0f0f0; padding: 8px; border-radius: 4px;"></div>

<label>Overall Stunt Difficulty Range</label>
<div id="StuntRange" style="background: #f0f0f0; padding: 8px; border-radius: 4px;"></div>

<label>Pyramid Skills Summary</label>
<div id="PyramidSkills" style="white-space: pre-wrap; background: #f0f0f0; padding: 8px; border-radius: 4px;"></div>

<label>Overall Pyramid Difficulty Range</label>
<div id="PyramidRange" style="background: #f0f0f0; padding: 8px; border-radius: 4px;"></div>
</div>




<!-- ========================END HTML VISUAL======================== -->


<script>

/*********SHOW INFO ‚ìò POP UP*********/

function showInfo(id) {  document.getElementById(id).style.display = "block";}
function closeInfo(id) {  document.getElementById(id).style.display = "none";}

/************************************************ 
|                                               |
|            STUNT & PYRAMID RUBRIC             |
|                                               |
************************************************/


//Labels for all stunt & pyramid skills
const StuntRegions = [
  { id: 'i1', skill: 'Non-Release Inversions - Prep Level and Below to Below Prep', category: 'Inversion', difficulty: 'Beginner'},
  { id: 'i2', skill: 'Below Prep Level Inversions to Ground', category: 'Inversion', difficulty: 'Beginner' },
  { id: 'i3', skill: 'Released Inversion Prep Level or Below to Below Prep', category: 'Inversion', difficulty: 'Beginner' },
  { id: 'i4', skill: 'Non-Release Inversions - Prep Level and Below to Prep', category: 'Inversion', difficulty: 'Intermediate' },
  { id: 'i5', skill: 'Suspended Forward Roll Variations & Inversions', category: 'Inversion', difficulty: 'Intermediate' },  
  { id: 'i6', skill: 'Released Inversions Prep Level or Below to Prep', category: 'Inversion', difficulty: 'Intermediate' },
  { id: 'i7', skill: 'Non-Release Inversions Prep Level and Below to Extended', category: 'Inversion', difficulty: 'Advanced' },
  { id: 'i8', skill: 'Released Inversions Prep Level or Below to Extended', category: 'Inversion', difficulty: 'Advanced' },
  { id: 'i9', skill: 'Non-Release Twisting Inversions Prep Level and Below to Extended', category: 'Inversion', difficulty: 'Elite' },
  { id: 'i10', skill: 'Released Inversions Prep Level or Below to Extended IBP', category: 'Inversion', difficulty: 'Elite' },
  { id: 'i11', skill: 'Alternate Entries to Hand to Hand Stunts', category: 'Inversion', difficulty: 'Elite' },
  { id: 'i12', skill: 'Released Inversions Prep Level or Below to Extended ABP', category: 'Inversion', difficulty: 'Super Elite' },
  { id: 'i13', skill: 'Twisting Released Inversion to Extended', category: 'Inversion', difficulty: 'Super Elite' },
  
  { id: 'r1', skill: 'Release to Below Prep', category: 'Release', difficulty: 'Beginner' },
  { id: 'r2', skill: 'Horizontal Releases to Below Prep', category: 'Release', difficulty: 'Beginner' },
  { id: 'r3', skill: 'Extended Release to Below Prep', category: 'Release', difficulty: 'Beginner' },
  
  { id: 't1', skill: '1/4 or 1/2 Up to Prep Level', category: 'Twisting', difficulty: 'Beginner' },
  { id: 't2', skill: '1/4 Up to Extended', category: 'Twisting', difficulty: 'Beginner' },
  { id: 't3', skill: '1/4 or 1/2 Twisting Transitions', category: 'Twisting', difficulty: 'Beginner' },
  
  { id: 'c1', skill: 'Single Base at Prep Level', category: 'Coed', difficulty: 'Beginner' },
  { id: 'c2', skill: 'Assisted Coed Skills to Prep', category: 'Coed', difficulty: 'Beginner' },
  { id: 'c3', skill: 'Assisted Walk-In/Toss to Chair', category: 'Coed', difficulty: 'Beginner' },
  
  { id: 'o1', skill: 'Prep Level and Below Stunts Not Previously Categorized', category: 'Toss', difficulty: 'Beginner' },
  { id: 'o2', skill: 'Straight Ride or Pretty Girl Tosses', category: 'Toss', difficulty: 'Beginner' },
  { id: 'o3', skill: 'Extended Stunts Not Previously Categorized', category: 'Toss', difficulty: 'Intermediate' },
  { id: 'o4', skill: 'Single Skill Tosses', category: 'Toss', difficulty: 'Intermediate' },
  { id: 'o5', skill: 'Multi-Skill Tosses', category: 'Toss', difficulty: 'Advanced' },
  { id: 'o6', skill: 'Single-Skill Tosses with Full Twist', category: 'Toss', difficulty: 'Elite' }, 
  { id: 'o7', skill: 'Multi-Skill Tosses with Full Twist', category: 'Toss', difficulty: 'Super Elite' },
  
  { id: 'h1', skill: 'TEST', category: 'Inversion', difficulty: 'Advanced' },
  { id: 'h2', skill: 'TEST', category: 'Release', difficulty: 'Elite' },
  { id: 'h3', skill: 'TEST', category: 'Twisting', difficulty: 'Super Elite' }
];

const PyramidRegions = [
  { id: 'n1', skill: 'Braced Non-Released Transitions', category: 'Inversion', difficulty: 'Beginner' },
  { id: 'n2', skill: 'Inverted Stunts to Prep Level and Below', category: 'Inversion', difficulty: 'Beginner' },
  { id: 'n3', skill: 'Intermediate Twisting Stunt Variations', category: 'Inversion', difficulty: 'Beginner' },
  { id: 'n4', skill: 'Unbraced Non-Released Transitions', category: 'Inversion', difficulty: 'Intermediate' },

  { id: 'pr1', skill: 'Braced Release to Prep or Below (1 or 2)', category: 'Release', difficulty: 'Beginner' },
  { id: 'pr2', skill: 'Braced Release to Extended (2)', category: 'Release', difficulty: 'Beginner' },
  { id: 'pr3', skill: 'Braced Release to Extended (1)', category: 'Release', difficulty: 'Intermediate' },
 
  { id: 'b1', skill: 'Rolling Transition to Prep Level or Below', category: 'Twisting', difficulty: 'Advanced' },
  { id: 'b2', skill: 'Flipping Transition Landing Below Prep Level (1 or 2)', category: 'Twisting', difficulty: 'Elite' },
  { id: 'b3', skill: '1/4 Twisting Flipping Transition Landing at Prep or Below (1 or 2)', category: 'Twisting', difficulty: 'Super Elite' },
];

const wrapper = document.querySelector('.wrapper');
const skillCountsContainer = document.getElementById('skillCounts');

const pyramidWrapper = document.getElementById('PyramidRubricSVG').closest('.wrapper');
const pyramidCountsContainer = document.getElementById('PyramidCounts');


// CLICK HANDLER FOR STUNTS
  (function() {
  
    const fallbackRegions = [
      { id: 'i1', skill: 'Connected Inversions - Prep Level and Below to Below Prep', category: 'Inversion', difficulty: 'Beginner'},
      { id: 'i2', skill: 'Below Prep Level Inversions to Ground', category: 'Inversion', difficulty: 'Beginner' },
      { id: 'i3', skill: 'Released Inversion Prep Level or Below to Below Prep', category: 'Inversion', difficulty: 'Beginner' },
      { id: 'i4', skill: 'Connected Inversions - Prep Level and Below to Prep', category: 'Inversion', difficulty: 'Intermediate' },
      { id: 'r1', skill: 'Release to Below Prep', category: 'Release', difficulty: 'Beginner' },
      { id: 'r2', skill: 'Horizontal Releases to Below Prep', category: 'Release', difficulty: 'Beginner' },
      { id: 'r3', skill: 'Extended Release to Below Prep', category: 'Release', difficulty: 'Beginner' },
      { id: 't1', skill: '1/4 or 1/2 Up to Prep Level', category: 'Twisting', difficulty: 'Beginner' },
      { id: 't2', skill: '1/4 Up to Extended', category: 'Twisting', difficulty: 'Beginner' },
      { id: 't3', skill: '1/4 or 1/2 Twisting Transitions', category: 'Twisting', difficulty: 'Beginner' },
      { id: 'c1', skill: 'Single Base at Prep Level', category: 'Coed', difficulty: 'Beginner' },
      { id: 'c2', skill: 'Assisted Coed Skills to Prep', category: 'Coed', difficulty: 'Beginner' },
      { id: 'c3', skill: 'Assisted Walk-In/Toss to Chair', category: 'Coed', difficulty: 'Beginner' },
      { id: 'o1', skill: 'Prep Level and Below Stunts Not Previously Categorized', category: 'Toss', difficulty: 'Beginner' },
      { id: 'o2', skill: 'Straight Ride or Pretty Girl Tosses', category: 'Toss', difficulty: 'Beginner' },
      { id: 'o3', skill: 'Extended Stunts Not Previously Categorized', category: 'Toss', difficulty: 'Intermediate' },
      { id: 'h1', skill: 'TEST', category: 'Inversion', difficulty: 'Advanced' },
      { id: 'h2', skill: 'TEST', category: 'Release', difficulty: 'Elite' },
      { id: 'h3', skill: 'TEST', category: 'Twisting', difficulty: 'Super Elite' }
    ];

  // If StuntRegions[] exists, use it. Otherwise fallback.
    const Regions = (typeof StuntRegions !== 'undefined' && Array.isArray(StuntRegions)) ? StuntRegions : fallbackRegions;

    function getRegionById(id) {
      return Regions.find(r => r.id === id) || { id: id, skill: id, difficulty: '' };
    }

    const svg = document.getElementById('StuntRubricSVG');
    if (!svg) return;

    const skillCountsContainer = document.getElementById('skillCounts');

    // ---- ADD ROW TO STUNT TABLE ----
    function addRowForRegion(region) {
      const skillId = 'count_' + region.id;
      // create new row
      const row = document.createElement('tr');
      row.id = skillId + '_' + Date.now();
      row.draggable = true;
      row.innerHTML = `
        <td class="drag-handle">${region.skill}</td>
        <td>${region.difficulty}</td>
        <td><input type="number" id="${skillId}" min="0" value="0"></td>
        <td class="delete-btn">üóëÔ∏è</td>
      `;
      skillCountsContainer.appendChild(row);

      // ---- DELETE BUTTON ----
      row.querySelector('.delete-btn').addEventListener('click', () => {
        if (row.parentElement) row.parentElement.removeChild(row);
      });

      // ---- DRAG & DROP FUNCTIONALITY ----
      row.addEventListener('dragstart', e => {
        e.dataTransfer.effectAllowed = 'move';
        window.__draggedRow = row;
      });
    }

    // ---- FLASH EFFECT ----
    function flashRect(rectEl) {
      rectEl.classList.add('svg-flash');
      setTimeout(() => rectEl.classList.add('fadeout'), 220);
      setTimeout(() => {
        rectEl.classList.remove('svg-flash', 'fadeout');
      }, 520);
    }

    // ---- CLICK & KEYBOARD EVENTS ----
    Regions.forEach(r => {
      try {
        const el = document.getElementById(r.id);
        if (!el) return;
        el.addEventListener('click', (ev) => {
          flashRect(el);
          addRowForRegion(r);
          ev.stopPropagation();
        });
   
        el.setAttribute('tabindex', '0');
        el.addEventListener('keydown', (ev) => {
          if (ev.key === 'Enter' || ev.key === ' ') {
            ev.preventDefault();
            el.click();
          }
        });
      } catch (err) {
        // continue if one region fails
        console.warn('SVG region attach error for', r.id, err);
      }
    });
  })();




// DRAG‚ÄìDROP FOR STUNT TABLE
let draggedRow = null;

	skillCountsContainer.addEventListener('dragstart', e => {
	draggedRow = e.target.closest('tr');
	if (draggedRow) e.dataTransfer.effectAllowed = 'move';
	});

	skillCountsContainer.addEventListener('dragover', e => {
	e.preventDefault();
	const targetRow = e.target.closest('tr');
	if (!targetRow || targetRow === draggedRow) return;

	const rect = targetRow.getBoundingClientRect();
	const next = (e.clientY - rect.top) > rect.height / 2;
	skillCountsContainer.insertBefore(draggedRow, next ? targetRow.nextSibling : targetRow);
	});

	skillCountsContainer.addEventListener('drop', e => {
	e.preventDefault();
	draggedRow = null;
	});

// CLICK HANDLER FOR PYRAMID RUBRIC
(function () {

  const fallbackPyramidRegions = [
    { id: "n1",  skill: "Braced non-released transitions", category: "Non-Released Transition", difficulty: "Beginner" },
    { id: "n2",  skill: "Inverted stunts to prep level and below", category: "Non-Released Transition", difficulty: "Beginner" },
    { id: "n3",  skill: "Intermediate twisting stunt variations", category: "Non-Released Transition", difficulty: "Beginner" },
    { id: "n4",  skill: "Unbraced non-released transitions", category: "Non-Released Transition", difficulty: "Intermediate" },

    { id: "pr1", skill: "Braced release to prep or below", category: "Released Transition", difficulty: "Beginner" },
    { id: "pr2", skill: "Braced release to extended (2)", category: "Released Transition", difficulty: "Beginner" },
    { id: "pr3", skill: "Braced release to extended (1)", category: "Released Transition", difficulty: "Intermediate" },

    { id: 'b1', skill: 'Rolling Transition to Prep Level or Below', category: 'Twisting', difficulty: 'Advanced' },
    { id: 'b2', skill: 'Flipping Transition Landing Below Prep Level (1 or 2)', category: 'Twisting', difficulty: 'Elite' },
    { id: 'b3', skill: '1/4 Twisting Flipping Transition Landing at Prep or Below (1 or 2)', category: 'Twisting', difficulty: 'Super Elite' }
  ];

  // If PyramidRegions[] exists, use it. Otherwise fallback.
  const Regions = (typeof PyramidRegions !== "undefined" && Array.isArray(PyramidRegions))
    ? PyramidRegions
    : fallbackPyramidRegions;

  const svg = document.getElementById("PyramidRubricSVG");
  if (!svg) return;

  const pyramidCountsContainer = document.getElementById("PyramidCounts");

  // ---- FLASH EFFECT ----
  function flashRect(rectEl) {
    rectEl.classList.add("svg-flash");
    setTimeout(() => rectEl.classList.add("fadeout"), 220);
    setTimeout(() => {
      rectEl.classList.remove("svg-flash", "fadeout");
    }, 520);
  }

  // ---- ADD ROW TO PYRAMID TABLE ----
  function addPyramidRow(region) {
    const skillId = "pcount_" + region.id;

    const row = document.createElement("tr");
    row.id = skillId + "_" + Date.now();
    row.draggable = true;

    row.innerHTML = `
      <td class="drag-handle">${region.skill}</td>
      <td>${region.difficulty}</td>
      <td><input type="number" id="${skillId}" min="0" value="0"></td>
      <td class="delete-btn">üóëÔ∏è</td>
    `;

    pyramidCountsContainer.appendChild(row);

    // ---- DELETE BUTTON ----
    row.querySelector(".delete-btn").addEventListener("click", () => {
      row.remove();
    });

    // ---- DRAG & DROP FUNCTIONALITY ----
    row.addEventListener("dragstart", (ev) => {
      ev.dataTransfer.effectAllowed = "move";
      window.__draggedPyramidRow = row;
    });
  }

  // ---- CLICK & KEYBOARD EVENTS ----
  Regions.forEach(region => {
    const rect = document.getElementById(region.id);
    if (!rect) return;

    rect.style.cursor = "pointer";
    rect.setAttribute("tabindex", "0");

    rect.addEventListener("click", (ev) => {
      flashRect(rect);
      addPyramidRow(region);
      ev.stopPropagation();
    });

    rect.addEventListener("keydown", (ev) => {
      if (ev.key === "Enter" || ev.key === " ") {
        ev.preventDefault();
        rect.click();
      }
    });
  });

})();


// DRAG‚ÄìDROP FOR PYRAMID TABLE
let draggedPyramidRow = null;

	pyramidCountsContainer.addEventListener('dragstart', e => {
	draggedPyramidRow = e.target.closest('tr');
	if (draggedPyramidRow) e.dataTransfer.effectAllowed = 'move';
	});

	pyramidCountsContainer.addEventListener('dragover', e => {
	e.preventDefault();
	const targetRow = e.target.closest('tr');
	if (!targetRow || targetRow === draggedPyramidRow) return;
	
	const rect = targetRow.getBoundingClientRect();
	const next = (e.clientY - rect.top) > rect.height / 2;
	pyramidCountsContainer.insertBefore(draggedPyramidRow, next ? targetRow.nextSibling : targetRow);
	});

	pyramidCountsContainer.addEventListener('drop', e => {
	e.preventDefault();
	draggedPyramidRow = null;
	});

// DIFFICULTY CHECKER FOR STUNTS
function runChecker() {
  const numAthletes = parseInt(document.getElementById('numAthletes').value) || 0;
  const majorityStunt = numAthletes <= 15 ? 2 : 3;

  const rows = document.querySelectorAll('#skillCounts tr');
  let majoritySkills = [];
  let outputText = 'Selected Stunt Skills:\n\n';

  // Step 1: Reset table coloring
  rows.forEach((row, idx) => {
    // skip header if (idx === 0) return; 
    row.classList.remove('majority', 'non-majority');
  });

  // Step 2: Label Non-Majority Skills and gather majority skills
  rows.forEach((row, idx) => {
    // skip header if (idx === 0) return; 
    const skill = row.cells[0].textContent;
    const difficulty = row.cells[1].textContent;
    const count = parseInt(row.cells[2].querySelector('input').value) || 0;

    if (count >= majorityStunt) {
      majoritySkills.push({ skill, difficulty });
      row.classList.add('majority');
      outputText += `${count} ‚Äî ${difficulty} ‚Äî ${skill} \n`;
    } else {
      row.classList.add('non-majority');
      outputText += `${count} ‚Äî ${difficulty} ‚Äî ${skill} (Non Majority)\n`;
    }
  });

  // Step 3: Define difficulty levels for sorting
  const difficultyLevels = {
    'Beginner': 1,
    'Intermediate': 2,
    'Advanced': 3,
    'Elite': 4,
    'Super Elite': 5
  };

  // Step 4: Count how many majority skills are at each difficulty
  const difficultyCount = {};
  majoritySkills.forEach(s => {
    difficultyCount[s.difficulty] = (difficultyCount[s.difficulty] || 0) + 1;
  });

  // Step 5: Sort difficulties from highest to lowest
  const sortedDifficulties = Object.keys(difficultyLevels).sort(
    (a, b) => difficultyLevels[b] - difficultyLevels[a]
  );

  // Step 6: Determine overall difficulty based on cumulative majority
  let overallStuntDifficulty = null;
  const startingIndex = sortedDifficulties.findIndex(d => difficultyCount[d] >= 1);

  if (startingIndex !== -1) {
    let cumulative = 0;
    // Step down from highest to lowest, adding cumulative majority skills
    for (let i = startingIndex; i < sortedDifficulties.length; i++) {
      cumulative += (difficultyCount[sortedDifficulties[i]] || 0);
      if (cumulative >= 2) {
        overallStuntDifficulty = sortedDifficulties[i]; // first range that meets cumulative majority
        break;
      }
    }
  }

  // Step 7: Output results
  outputText += `\nRequired Number of Groups for Majority: ${majorityStunt}`;
  outputText += `\nOverall Difficulty Range: ${overallStuntDifficulty || 'Selected skills do not meet rubric requirements for majority'}`;

  document.getElementById('output').textContent = outputText;
  
 // Step 8: Populate Summary 
	let StuntSkillListOutput = '';
		rows.forEach(row => {
    const skill = row.cells[0].textContent;
    const difficulty = row.cells[1].textContent;
    const count = parseInt(row.cells[2].querySelector('input').value) || 0;
    StuntSkillListOutput += `${count} ‚Äî ${difficulty} ‚Äî ${skill} `;
    if (!row.classList.contains('majority')) StuntSkillListOutput += ' (Non Majority)';
    StuntSkillListOutput += '\n';
});
	document.getElementById('StuntSkills').textContent = StuntSkillListOutput;
	document.getElementById('StuntRange').textContent = overallStuntDifficulty || 'Rubric Requirements Not Met';
	
}


// DIFFICULTY CHECKER FOR PYRAMID
function runChecker2() {
  const numAthletes = parseInt(document.getElementById('numAthletes').value) || 0;
  const majorityPyramid = numAthletes <= 15 ? 1 : 2;

  const rows = document.querySelectorAll('#PyramidCounts tr');
  let majoritySkills = [];
  let outputText = 'Selected Pyramid Skills:\n\n';

  // Step 1: Reset table coloring
  rows.forEach(row => row.classList.remove('majority', 'non-majority'));

  // Step 2: Label Non-Majority Skills and gather majority skills
  rows.forEach(row => {
    const skill = row.cells[0].textContent;
    const difficulty = row.cells[1].textContent;
    const count = parseInt(row.cells[2].querySelector('input').value) || 0;

    if (count >= majorityPyramid) {
      majoritySkills.push({ skill, difficulty });
      row.classList.add('majority');
      outputText += `${count} ‚Äî ${difficulty} ‚Äî ${skill}\n`;
    } else {
      row.classList.add('non-majority');
      outputText += `${count} ‚Äî ${difficulty} ‚Äî ${skill} (Non Majority)\n`;
    }
  });

 // Step 3: Define difficulty levels for sorting
  const difficultyLevels = {
    'Beginner': 1,
    'Intermediate': 2,
    'Advanced': 3,
    'Elite': 4,
    'Super Elite': 5
  };

  // Step 4: Count how many majority skills are at each difficulty
  const difficultyCount = {};
  majoritySkills.forEach(s => {
    difficultyCount[s.difficulty] = (difficultyCount[s.difficulty] || 0) + 1;
  });

  // Step 5: Sort difficulties from highest to lowest
  const sortedDifficulties = Object.keys(difficultyLevels).sort(
    (a, b) => difficultyLevels[b] - difficultyLevels[a]
  );

  // Step 6: Determine overall difficulty based on cumulative majority
  let overallPyramidDifficulty = null;
  const startingIndex = sortedDifficulties.findIndex(d => difficultyCount[d] >= 1);

  if (startingIndex !== -1) {
    let cumulative = 0;
    for (let i = startingIndex; i < sortedDifficulties.length; i++) {
      cumulative += (difficultyCount[sortedDifficulties[i]] || 0);
      if (cumulative >= 3) {
        overallPyramidDifficulty = sortedDifficulties[i];
        break;
      }
    }
  }

  // Step 7: Output results
  outputText += `\nRequired Number of Trick Flyers for Majority: ${majorityPyramid}`;
  outputText += `\nOverall Difficulty Range: ${overallPyramidDifficulty || 'Selected skills do not meet rubric requirements for majority'}`;

  document.getElementById('outputp').textContent = outputText;

 // Step 8: Populate Summary 
  let PyramidSkillListOutput = '';
  rows.forEach(row => {
    const skill = row.cells[0].textContent;
    const difficulty = row.cells[1].textContent;
    const count = parseInt(row.cells[2].querySelector('input').value) || 0;

    PyramidSkillListOutput += `${count} ‚Äî ${difficulty} ‚Äî ${skill}`;
    if (!row.classList.contains('majority')) PyramidSkillListOutput += ' (Non Majority)';
    PyramidSkillListOutput += '\n';
  });

  document.getElementById('PyramidSkills').textContent = PyramidSkillListOutput;
  document.getElementById('PyramidRange').textContent = overallPyramidDifficulty || 'Rubric Requirements Not Met';
}


/************************************************ 
|                                               |
|            TUMBLING & JUMP RUBRIC             |
|                                               |
************************************************/

//================== Tumbling Selection ==================
document.querySelectorAll('.tumblinghighlight.tumbling').forEach(box => {
    box.addEventListener('click', () => {
        document.querySelectorAll('.tumblinghighlight.tumbling').forEach(b => b.classList.remove('selected'));
        box.classList.add('selected');

        const output = document.getElementById('TumblingOutput');
        const value = box.dataset.value || "";
        output.dataset.selected = value; // store selected value for validation
        output.innerText = value ? `Tumbling Difficulty Range: ${value}` : "";
    });
});

//================== Jump Selection ==================
document.querySelectorAll('.jumphighlight.jump').forEach(box => {
    box.addEventListener('click', () => {
        document.querySelectorAll('.jumphighlight.jump').forEach(b => b.classList.remove('selected'));
        box.classList.add('selected');

        const output = document.getElementById('JumpOutput');
        const value = box.dataset.value || "";
        output.dataset.selected = value; // store selected value for validation
        output.innerText = value ? `Jump Difficulty Range: ${value}` : "";
    });
});



/************************************************ 
|                                               |
|                APPS SCRIPT FOR                |
|           DATE/LOCATION DROP DOWN             |
|  + ASSOCIATION GOOGLE SHEET SUBMISSION        |
|                                               |
************************************************/


//====== SET YOUR APPS SCRIPT WEB APP URL =======//

const APPS_SCRIPT_BASE = "https://script.google.com/macros/s/AKfycbzA1BxBeDj23K-E_NLNlen__bTH0Iy7Q0lBTs6A0N_-sjhpznRGzFx7WLlBrFBww25AqA/exec";  // <-- REPLACE THIS


		/*****************************************************
		1) POPULATE COMPETITION LOCATION DROPDOWN
		*****************************************************/

		async function populateCompetitionLocations() {
		try {
			const response = await fetch(`${APPS_SCRIPT_BASE}?sheetName=Events`);
			if (!response.ok) throw new Error("Failed to load competitions");

			const data = await response.json();
			const select = document.getElementById("competitionLocation");
			select.innerHTML = `<option value="">--Select--</option>`;

			data.forEach(item => {
			const option = document.createElement("option");
			const display = `${item.date} - ${item.eventname} @ ${item.location}`;
			option.textContent = display;
			option.value = JSON.stringify(item);
			option.dataset.association = item.association || "";
			select.appendChild(option);
			});

		} catch (err) {
			console.error("Competition fetch error:", err);
			}
		}
		window.addEventListener("load", populateCompetitionLocations);
	



		/*****************************************************
		2) COLLECT TABLE COUNTS
		*****************************************************/
		function collectTableCounts(selector) {
		const rows = document.querySelectorAll(selector + " tr");
		const arr = [];
		rows.forEach(row => {
			const tds = row.querySelectorAll("td");
			if (tds.length < 3) return;

			const skill = tds[0].textContent.trim();
			const difficulty = tds[1].textContent.trim();
			const input = tds[2].querySelector("input");
			const count = input ? parseInt(input.value) || 0 : 0;

			arr.push({ skill, difficulty, count });
		});
		return arr;
		}



		/*****************************************************
		3) SUBMISSION ‚Üí SEND TO GOOGLE APP SCRIPT
		*****************************************************/
		
				//================== Custom Alert ==================
		function showCustomAlert(message) {
			const alertDiv = document.getElementById('customAlert');
			document.getElementById('customAlertText').textContent = message;
			alertDiv.style.display = 'flex';
			document.getElementById('customAlertOk').onclick = () => { alertDiv.style.display = 'none'; };
		}

		async function appsScriptSubmissionFlow() {

		const competitionValue = document.getElementById("competitionLocation").value;
		const competition_raw = competitionValue ? JSON.parse(competitionValue) : {};
		const association = competition_raw.association || "Unknown";

			const payload = {
			association: association,
			competition_selection: document.getElementById("competitionLocation").selectedOptions[0].textContent,
			competition_raw: competition_raw,

			fields: {
			schoolName: document.getElementById("schoolName").value,
			teamLevel: document.getElementById("teamLevel").value,
			CoachName: document.getElementById("CoachName").value,
			CoachEmail: document.getElementById("CoachEmail").value,
			numAthletes: document.getElementById("numAthletes").value,
			StuntSkills: document.getElementById("StuntSkills").textContent,
			StuntRange: document.getElementById("StuntRange").textContent,
			PyramidSkills: document.getElementById("PyramidSkills").textContent,
			PyramidRange: document.getElementById("PyramidRange").textContent,
			TumblingOutput: document.getElementById("TumblingOutput").dataset.selected || "",
			teamSync: document.getElementById("teamSync").value,
			additionalTumbling: document.getElementById("additionalTumbling").value,
			JumpOutput: document.getElementById("JumpOutput").dataset.selected || "",
			jumpSequence: document.getElementById("jumpSequence").value,
			legalityRulings: document.getElementById("legalityRulings").value
			},

			skillCounts: collectTableCounts("#skillCounts"),
			pyramidCounts: collectTableCounts("#PyramidCounts"),

			timestamp: new Date().toISOString()
		};

		try {
			await fetch(APPS_SCRIPT_BASE, {
			method: "POST",
			mode: "no-cors",
			headers: { "Content-Type": "application/json" },
			body: JSON.stringify(payload)
			});

			showCustomAlert("Submission sent successfully!");
  
			//  HIDE SPINNER AFTER SUCCESSFUL SUBMISSION
				document.getElementById("loadingOverlay").style.display = "none";
				triggerConfetti();   // üéâ CONFETTI!!!!!


		} catch (err) {
		
		    // Also hide spinner if an error occurs too
				document.getElementById("loadingOverlay").style.display = "none";
	
			showCustomAlert("Network error sending submission: " + err.message);
		}
		}

/************************************************ 
|                                               |
|          VALIDATION & SUBMIT FORM             |
|                                               |
************************************************/


//----CHECK FOR ALL FIELDS TO BE POPULATED & OUTPUT ERROR MESSAGE FOR ANY MISSING----//


//Display a small checkmark ‚úîÔ∏è next to any completed field
function addCompletionCheckmarks() {
  const fields = document.querySelectorAll('input, select, textarea');

  fields.forEach(field => {
    field.addEventListener('input', () => toggleCheck(field));
    field.addEventListener('change', () => toggleCheck(field));
  });

  function toggleCheck(field) {
    const value = field.value.trim();
    if (value) {
      field.classList.add('completed');
    } else {
      field.classList.remove('completed');
    }
  }
}

window.addEventListener("load", addCompletionCheckmarks);


// ---------------------------- CONFETTI FOR SUCCESSFULL SUBMISSION ----------------------------

function triggerConfetti() {
  const container = document.getElementById("confettiContainer");
  container.innerHTML = "";
  container.style.display = "block";

  const colors = ["#F8DF00", "#2F317D", "#c02025"]; // VHSL palette
  const pieces = 1000;

  for (let i = 0; i < pieces; i++) {
    const confetti = document.createElement("div");
    confetti.classList.add("confetti-piece");

    const size = Math.random() * 6 + 4;
    confetti.style.width = `${size}px`;
    confetti.style.height = `${size}px`;

    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
    confetti.style.left = Math.random() * 100 + "vw";
    const randomYOffset = -20 - Math.random() * 120; // up to 140px above view
confetti.style.transform = `translateY(${randomYOffset}px) rotate(${Math.random() * 360}deg)`;
confetti.style.animationDelay = (Math.random() * 0.6) + "s";


    container.appendChild(confetti);
  }

  // Hide after animation finishes
  setTimeout(() => {
    container.style.display = "none";
  }, 1700);
}



		//================== üëâSave & Submit Handler ==================
		document.getElementById("saveBtn").addEventListener("click", () => {

			// Run the difficulty checkers first
			runChecker();
			runChecker2();

			// Define required fields
			const requiredFields = [
				{ id: 'schoolName', label: 'School Name' },
				{ id: 'teamLevel', label: 'Team Level' },
				{ id: 'CoachName', label: 'Head Coach Name' },
				{ id: 'CoachEmail', label: 'Head Coach Email' },
				{ id: 'numAthletes', label: 'Number of Athletes Performing' },
				{ id: 'competitionLocation', label: 'Competition Location' },
				{ id: 'StuntSkills', label: 'Stunt Skills' },
				{ id: 'PyramidSkills', label: 'Pyramid Skills' },
				{ id: 'TumblingOutput', label: 'Tumbling Difficulty Range' },
				{ id: 'teamSync', label: 'Team Majority Sync Sequence Description' },
				{ id: 'additionalTumbling', label: 'Additional Tumbling Skills Description' },
				{ id: 'JumpOutput', label: 'Jump Difficulty Range' },
				{ id: 'jumpSequence', label: 'Jump Sequence Description' },
				{ id: 'legalityRulings', label: 'Any Legality Rulings from Bill Ahern?' }
			];

			let missingFields = [];

			//Validation of missing fields
				requiredFields.forEach(f => {
				const field = document.getElementById(f.id);
				if (!field) return;

				field.style.border = ""; // reset border
				let fieldValue = "";

			// Standard input/textarea/select
				if (field.tagName === "INPUT" || field.tagName === "TEXTAREA" || field.tagName === "SELECT") {
				fieldValue = field.value.trim();}
    
			// Tumbling/Jump output divs
				else if (f.id === "TumblingOutput" || f.id === "JumpOutput") {
   
			// Use dataset.selected if it exists, otherwise check innerText after the colon
				fieldValue = field.dataset.selected || "";	}

			// Stunt/Pyramid tables
				else if (f.id === "StuntSkills" || f.id === "PyramidSkills") {
				const tableId = f.id === "StuntSkills" ? "#skillCounts" : "#PyramidCounts";
				const rows = document.querySelectorAll(tableId + " tr");
				const hasCount = Array.from(rows).some(row => {
				const input = row.querySelector('input');
				return input && parseInt(input.value, 10) > 0;   });
				fieldValue = hasCount ? "filled" : ""; }
    
			// Any Other <div> options
				else {fieldValue = field.textContent.trim(); }

				if (!fieldValue) {
				missingFields.push(f.label);
				field.style.border = "2px solid red";}
		});			


			if (missingFields.length > 0) {
				showCustomAlert(
					"All fields are required before submission. Please fill out the missing fields:\n\n" +
					missingFields.join("\n")
				);

			return; // stop submission if anything is missing
			}
			
					//  Show spinner animation
		document.getElementById("loadingOverlay").style.display = "flex";

    // ‚úÖ!!!!!!!EVERYTHING IS VALIDATED - SUBMIT TO GOOGLE SHEETS!!!!!!!‚úÖ //
		appsScriptSubmissionFlow();

		});
 

/************************************************
|          LOCAL AUTOSAVE SYSTEM                |
************************************************/

// Save full form state to localStorage
function autosaveForm() {
    const data = {};

    // Simple text / number / select fields
    const simpleFields = [
        "schoolName","teamLevel","CoachName","CoachEmail",
        "numAthletes","competitionLocation","teamSync",
        "additionalTumbling","jumpSequence","legalityRulings"
    ];
    simpleFields.forEach(id => {
        const el = document.getElementById(id);
        if (el) data[id] = el.value || "";
    });

    // Tumbling + Jump selected ranges
    data["TumblingOutput"] = document.getElementById("TumblingOutput").dataset.selected || "";
    data["JumpOutput"] = document.getElementById("JumpOutput").dataset.selected || "";

    // Stunt & Pyramid tables
    data["skillCounts"] = collectTableCounts("#skillCounts");
    data["pyramidCounts"] = collectTableCounts("#PyramidCounts");

    // Save to localStorage
    localStorage.setItem("rubricFormAutosave", JSON.stringify(data));
}
function loadAutosave() {
    const saved = localStorage.getItem("rubricFormAutosave");
    if (!saved) return;
    const data = JSON.parse(saved);

    // Restore simple fields
    Object.keys(data).forEach(key => {
        const el = document.getElementById(key);
        if (el && typeof data[key] === "string") {
            el.value = data[key];
        }
    });

    // Restore Tumbling selection
    if (data.TumblingOutput) {
        document.querySelectorAll(".tumblinghighlight").forEach(box => {
            if (box.dataset.value === data.TumblingOutput) {
                box.classList.add("selected");
            }
        });
        document.getElementById("TumblingOutput").innerText =
            "Tumbling Difficulty Range: " + data.TumblingOutput;
        document.getElementById("TumblingOutput").dataset.selected = data.TumblingOutput;
    }

    // Restore Jump selection
    if (data.JumpOutput) {
        document.querySelectorAll(".jumphighlight").forEach(box => {
            if (box.dataset.value === data.JumpOutput) {
                box.classList.add("selected");
            }
        });
        document.getElementById("JumpOutput").innerText =
            "Jump Difficulty Range: " + data.JumpOutput;
        document.getElementById("JumpOutput").dataset.selected = data.JumpOutput;
    }

    // Restore Stunt Table
    if (Array.isArray(data.skillCounts)) {
        data.skillCounts.forEach(item => {
            addRestoredStuntRow(item);
        });
    }

    // Restore Pyramid Table
    if (Array.isArray(data.pyramidCounts)) {
        data.pyramidCounts.forEach(item => {
            addRestoredPyramidRow(item);
        });
    }
}
function addRestoredStuntRow(item) {
    const row = document.createElement("tr");
    row.innerHTML = `
        <td class="drag-handle">${item.skill}</td>
        <td>${item.difficulty}</td>
        <td><input type="number" value="${item.count}" min="0"></td>
        <td class="delete-btn">üóëÔ∏è</td>
    `;
    document.getElementById("skillCounts").appendChild(row);
}

function addRestoredPyramidRow(item) {
    const row = document.createElement("tr");
    row.innerHTML = `
        <td class="drag-handle">${item.skill}</td>
        <td>${item.difficulty}</td>
        <td><input type="number" value="${item.count}" min="0"></td>
        <td class="delete-btn">üóëÔ∏è</td>
    `;
    document.getElementById("PyramidCounts").appendChild(row);
}
// Save whenever any input changes
document.querySelectorAll("input, textarea, select").forEach(el => {
    el.addEventListener("input", autosaveForm);
    el.addEventListener("change", autosaveForm);
});

// Save when stunt / pyramid skills are clicked
document.querySelectorAll(".svg-highlight").forEach(el => {
    el.addEventListener("click", autosaveForm);
});

// Save tumbling + jump
document.querySelectorAll(".tumblinghighlight, .jumphighlight").forEach(el => {
    el.addEventListener("click", autosaveForm);
});

// Load saved data on startup
window.addEventListener("load", loadAutosave);




// ========================= PREVIEW SUBMISSION POPUP =========================

(function(){
  document.addEventListener('DOMContentLoaded', () => {
    const previewBtn = document.getElementById("previewBtn");
    if (previewBtn) previewBtn.addEventListener("click", () => {
      try { window.generatePreview && window.generatePreview(); } catch(e){ console.error('Preview error', e); }
    });

    // attach print button safely
    const previewPrintBtn = document.getElementById("previewPrintBtn");
    if (previewPrintBtn) {
      previewPrintBtn.addEventListener("click", () => {
        const contentEl = document.getElementById("previewContent");
        const contentHTML = contentEl ? contentEl.innerHTML : "";
        const printWindow = window.open("", "_blank");
        printWindow.document.write(`
          <html><head><title>Coaches Rubric Summary</title>
          <style>
            body { font-family: Arial, sans-serif; padding:20px; color:#111; }
            .sectionTitle { margin-top:18px; font-weight:700; font-size:15px; }
            .divider { height:2px; background:#2F317D; margin:6px 0 10px 0; }
            pre { white-space:pre-wrap; font-size:14px; }
          </style>
          </head><body>${contentHTML}</body></html>`);
        printWindow.document.close();
        printWindow.focus();
        printWindow.print();
        printWindow.close();
      });
    }

  });

    window.generatePreview = function generatePreview() {
    // run existing checkers so Stunt/Pyramid summaries are up to date
    if (typeof runChecker === "function") try { runChecker(); } catch(e){ console.warn(e); }
    if (typeof runChecker2 === "function") try { runChecker2(); } catch(e){ console.warn(e); }

    // helper to safely return text (avoid 'undefined')
    function val(id){
      const el = document.getElementById(id);
      if(!el) return "";
      // For the competition <select>, return visible text if available
      if (el.tagName === "SELECT" && el.selectedOptions && el.selectedOptions[0]) {
        return el.selectedOptions[0].textContent || el.value || "";
      }
      // For divs that store selected values
      if (el.dataset && el.dataset.selected) return el.dataset.selected || el.textContent || "";
      return el.value !== undefined ? el.value : el.textContent;
    }
    // small helper to escape any user-provided HTML so content is safe
    function escapeHtml(unsafe){
      if (unsafe === null || unsafe === undefined) return "";
      return String(unsafe)
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
    }

    // Build HTML with divider blocks
    const parts = [];

    function section(title, content){
      parts.push(`<div class="sectionTitle" style="margin-top:18px;font-weight:700;font-size:15px;">${escapeHtml(title)}</div>`);
      parts.push(`<div class="divider" style="height:2px;background:#2F317D;margin:6px 0 10px 0;"></div>`);
      parts.push(`<div style="white-space:pre-wrap;font-size:14px;margin-bottom:8px;">${content}</div>`);
    }

    // Build each section content
    const school = escapeHtml(val("schoolName"));
    const teamLevel = escapeHtml(val("teamLevel"));
    const coach = escapeHtml(val("CoachName"));
    const email = escapeHtml(val("CoachEmail"));
    const athletes = escapeHtml(val("numAthletes"));
    const competition = escapeHtml(val("competitionLocation"));

    const StuntSkills = escapeHtml(document.getElementById("StuntSkills") ? document.getElementById("StuntSkills").textContent.trim() : "");
    const StuntRange = escapeHtml(document.getElementById("StuntRange") ? document.getElementById("StuntRange").textContent.trim() : "");
    const PyramidSkills = escapeHtml(document.getElementById("PyramidSkills") ? document.getElementById("PyramidSkills").textContent.trim() : "");
    const PyramidRange = escapeHtml(document.getElementById("PyramidRange") ? document.getElementById("PyramidRange").textContent.trim() : "");

    const TumblingDifficulty = escapeHtml(document.getElementById("TumblingOutput") ? (document.getElementById("TumblingOutput").dataset.selected || document.getElementById("TumblingOutput").textContent) : "");
    const teamSync = escapeHtml(val("teamSync"));
    const additionalTumbling = escapeHtml(val("additionalTumbling"));

    const JumpDifficulty = escapeHtml(document.getElementById("JumpOutput") ? (document.getElementById("JumpOutput").dataset.selected || document.getElementById("JumpOutput").textContent) : "");
    const jumpSequence = escapeHtml(val("jumpSequence"));

    const legality = escapeHtml(val("legalityRulings"));

    // Coach & Team Info
    section("COACH & TEAM INFO",
      `<strong>School:</strong> ${school}\n<strong>Team Level:</strong> ${teamLevel}\n<strong>Head Coach:</strong> ${coach}\n<strong>Head Coach Email:</strong> ${email}\n<strong>Number of Athletes Performing:</strong> ${athletes}\n<strong>Competition:</strong> ${competition}`);

    // Stunt
    section("STUNT SKILLS",
      `${StuntSkills || "(none recorded)"}\n\n<strong>Overall Stunt Range:</strong> ${StuntRange || "(not calculated)"}`);

    // Pyramid
    section("PYRAMID SKILLS",
      `${PyramidSkills || "(none recorded)"}\n\n<strong>Overall Pyramid Range:</strong> ${PyramidRange || "(not calculated)"}`);

    // Tumbling
    section("TUMBLING",
      `<strong>Tumbling Difficulty:</strong> ${TumblingDifficulty || "(none selected)"}\n\n<strong>Team Majority Sync Sequence:</strong>\n${teamSync || "(not provided)"}\n\n<strong>Additional Tumbling:</strong>\n${additionalTumbling || "(not provided)"}`);

    // Jumps
    section("JUMPS",
      `<strong>Jump Difficulty:</strong> ${JumpDifficulty || "(none selected)"}\n\n<strong>Jump Sequence:</strong>\n${jumpSequence || "(not provided)"}`);

    // Legality
    section("LEGALITY RULINGS",
      `${legality || "(not provided)"}`);

   
    const previewEl = document.getElementById("previewContent");
    if (previewEl) previewEl.innerHTML = parts.join("\n");
    else {      console.warn("previewContent element not found in DOM.");    }
    const modal = document.getElementById("previewModal");
    if (modal) {      modal.style.display = "flex";      modal.setAttribute("aria-hidden", "false");
      previewEl && previewEl.focus && previewEl.focus();    } 
	  else {      console.warn("previewModal element not found in DOM.");    }
  };
})();
window.closePreview = function () {
    const modal = document.getElementById("previewModal");
    if (modal) modal.style.display = "none";
};


</script>



<!-- ========================"SUBMITTING" LOADING SPINNER======================== -->
<div id="loadingOverlay">
  <div class="spinner"></div>
  <p style="color:white; margin-top:10px; font-size:18px;">Submitting...</p>
</div>



<!-- ========================ERROR ALERT MESSAGE======================== -->

<div id="customAlert" style="display:none;">
  <div id="customAlertContent">
    <p id="customAlertText"></p>
    <button id="customAlertOk">OK</button>
  </div>
</div>

<!-- ========================INFO ICON MESSAGE======================== -->

<div id="majorityInfo" class="info-popup">
  <h3>What Counts as a "Majority"?</h3>
  <p>For a complete breakdown, view the PDF: </p> 
  <p><a href="Majority_Breakdown.pdf" target="_blank">Download the Majority Breakdown PDF</a></p>
  <button onclick="closeInfo('majorityInfo')">Close</button>
</div>


<!-- ===================== PREVIEW POPUP ======================= -->
<div id="previewModal" style="display:none;    position: fixed;    top:0; left:0; width:100%; height:100%;
    background: rgba(0,0,0,0.6); z-index:99999;    justify-content: center; align-items: center; padding: 20px;">
  <div style="      background: #fff; max-width:760px; width:100%;      border-radius:10px; padding:22px;      max-height:86vh; overflow-y:auto;
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);      font-family: Arial, sans-serif;  ">
    <div style="display:flex; justify-content:space-between; align-items:center; gap:10px;">
      <h2 style="margin:0; font-size:26px; color:#c02025"><strong>Rubric Submission Preview</strong></h2>
      <div style="display:flex; gap:8px;">
        <button id="previewPrintBtn" style="padding:8px 12px; border-radius:6px; border:none; cursor:pointer; background:#2F317D; color:#fff;">Print</button>
        <button onclick="closePreview()" style="padding:8px 12px; border-radius:6px; border:none; cursor:pointer; background:#c02025; color:#fff;">Close</button>
	  </div>
    </div>
	  <span class="note-small">Click 'Print' to save this for an easier copy/paste on future submissions!</span>
    <div id="previewContent" style="white-space:pre-wrap; font-size:15px; margin-top:14px; color:#111;"></div>
  </div>
</div>

<div id="confettiContainer"></div>


</body>
</html>

