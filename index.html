<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NVCOA Cheer Coaches Full Form + Rubric</title>
<style>
  body { font-family: Arial, sans-serif; margin: 30px; background: #fafafa; }
  h1 { color: #800000; }
  label { display: block; margin-top: 15px; font-weight: bold; }
  input, select, textarea { width: 90%; max-width: 600px; padding: 8px; margin-top: 5px; }
  button { margin-top: 25px; padding: 10px 16px; background: #800000; color: white; border: none; border-radius: 5px; cursor: pointer; }
  button:hover { background: #a00000; }
  .wrapper { position: relative; display: inline-block; margin-top: 20px; }
  #rubricImage { width: 90%; max-width: 950px; display: block; }
  .highlight { position: absolute; border: 2px solid transparent; background-color: transparent; pointer-events: none; display: none; }
  .twisting { border-color: rgba(255,0,0,0.8); background-color: rgba(255,0,0,0.25); }
  .coed     { border-color: rgba(0,0,255,0.8); background-color: rgba(0,0,255,0.25); }
  .release  { border-color: rgba(0,180,0,0.8); background-color: rgba(0,180,0,0.25); }
  .inversion{ border-color: rgba(180,0,180,0.8); background-color: rgba(180,0,180,0.25); }
  .toss     { border-color: rgba(255,120,0,0.8); background-color: rgba(255,120,0,0.25); }
  #output { margin-top: 20px; white-space: pre-wrap; background: #f7f7f7; padding: 10px; border-radius: 5px; max-width: 950px; }
  table { width: 70%; max-width: 950px; border-collapse: collapse; margin-top: 10px; }
  th, td { padding: 6px 10px; text-align: left; border-bottom: 1px solid #ccc; }
  th { background: #f0f0f0; }
  .drag-handle { cursor: grab; font-size: 18px; }
  .delete-btn { cursor: pointer; color: #d00; font-size: 18px; text-align: center; }
  .hotpink-underline {
  color: hotpink;
  text-decoration: underline;
  }
  .icon {
  font-size: 24px;      /* Makes the icon bigger */
  vertical-align: middle; /* Aligns icon nicely with text */
  }
  .majority {
  background-color: rgba(0, 200, 0, 0.2); /* light green */
  }
  .non-majority {
  background-color: rgba(255, 0, 0, 0.2); /* light red */
  }

  
</style>
</head>
<body>

<h1>NVCOA Cheer Coaches Rubric + Full Form</h1>

<form id="fullForm" action="https://docs.google.com/forms/d/e/1FAIpQLSfQ3lyxpqbB0ej3RfpUok4s02UNwSfFExRDta7rATeTuqEg2g/formResponse" method="POST" target="hidden_iframe">

  <!-- Google Form Fields -->
  <label>School Name</label>
  <input type="text" id="schoolName">

  <label>Team Level</label>
  <select id="teamLevel">
    <option value="">--Select--</option>
    <option value="Varsity">Varsity</option>
    <option value="Junior Varsity">Junior Varsity</option>
  </select>

  <label>Number of Athletes Performing</label>
  <input type="number" id="numAthletes" min="1">

  <label>Competition Location</label>
  <input type="text" id="competitionLocation">

  <label>Competition Date</label>
  <input type="date" id="competitionDate">

  <h2>Stunt Skills Rubric</h2>
  <p><strong>Click on the rubric image to select skills.</strong></p>

  <div class="wrapper">
    <img id="rubricImage" src="Stunt_Rubric.png" alt="VHSL Rubric">
    <!-- Highlight boxes -->
    <div class="highlight inversion" id="i1" style="left:62px; top:131px; width:146px; height:17px;"></div>
    <div class="highlight inversion" id="i2" style="left:62px; top:150px; width:146px; height:18px;"></div>
    <div class="highlight inversion" id="i3" style="left:62px; top:169px; width:146px; height:17px;"></div>
    <div class="highlight inversion" id="i4" style="left:209px; top:131px; width:146px; height:17px;"></div>

    <div class="highlight release" id="r1" style="left:62px; top:217px; width:146px; height:15px;"></div>
    <div class="highlight release" id="r2" style="left:62px; top:233px; width:146px; height:13px;"></div>
    <div class="highlight release" id="r3" style="left:62px; top:280px; width:146px; height:14px;"></div>

    <div class="highlight twisting" id="t1" style="left:62px; top:335px; width:146px; height:7px;"></div>
    <div class="highlight twisting" id="t2" style="left:62px; top:342px; width:146px; height:14px;"></div>
    <div class="highlight twisting" id="t3" style="left:62px; top:356px; width:146px; height:15px;"></div>

    <div class="highlight coed" id="c1" style="left:62px; top:410px; width:146px; height:14px;"></div>
    <div class="highlight coed" id="c2" style="left:62px; top:439px; width:146px; height:15px;"></div>
    <div class="highlight coed" id="c3" style="left:62px; top:455px; width:146px; height:15px;"></div>

    <div class="highlight toss" id="o1" style="left:62px; top:555px; width:146px; height:15px;"></div>
    <div class="highlight toss" id="o2" style="left:62px; top:582px; width:146px; height:21px;"></div>
    <div class="highlight toss" id="o3" style="left:62px; top:600px; width:146px; height:15px;"></div>

    <div class="highlight inversion" id="h1" style="left:140px; top:550px; width:180px; height:20px;"></div>
    <div class="highlight release" id="h2" style="left:330px; top:550px; width:180px; height:20px;"></div>
    <div class="highlight twisting" id="h3" style="left:630px; top:550px; width:180px; height:20px;"></div>
  </div>

<p><strong>
Enter the number of stunt groups for each skill. 
<span class="hotpink-underline">Please list skills in order of performance.</span> 
Drag <span class="icon">‚áÖ</span> to reorder skills or click <span class="icon">üóëÔ∏è</span> to delete skills.
</strong></p>

  <!-- Drag & drop table -->
  <table id="skillCountsTable">
    <thead>
      <tr>
        <th style="width:30px;">‚áÖ</th>
        <th>Skill</th>
		<th>Difficulty</th>
        <th># of Stunt Groups</th>
        <th style="width:30px;">üóëÔ∏è</th>
      </tr>
    </thead>
    <tbody id="skillCounts"></tbody>
  </table>

<div style="display: flex; align-items: center; gap: 10px;">
  <button onclick="runChecker()">Check Overall Difficulty</button>
  <span style="font-style: italic; color: gray;">
    Majority skills will highlight in green and non-majority skills will highlight in red.
  </span>
</div>

  <div id="output"></div>



  <!-- Remaining Google Form fields (Pyramid, Tumbling, Jump, etc.) -->
  <label>Intended Pyramid Range</label>
  <select id="pyramidRange">
    <option value="">--Select--</option>
    <option>Beginner: 0.0 - 1.0</option>
    <option>Intermediate: 1.25 - 3.25</option>
    <option>Advanced: 3.5 - 5.5</option>
    <option>Elite: 5.75 - 7.75</option>
    <option>Super Elite: 8.0 - 10.0</option>
  </select>

  <label>Pyramid Skills Description</label>
  <textarea id="pyramidSkills" rows="3"></textarea>

  <label>Intended Tumbling Range</label>
  <select id="tumblingRange">
    <option value="">--Select--</option>
    <option>0.0 - 1.0</option>
    <option>1.25 - 2.5</option>
    <option>2.75 - 4.0</option>
    <option>4.25 - 5.0</option>
  </select>

  <label>Team Majority Sync Sequence Description</label>
  <textarea id="teamSync" rows="3"></textarea>

  <label>Additional Tumbling Skills Description</label>
  <textarea id="additionalTumbling" rows="3"></textarea>

  <label>Intended Jump Range</label>
  <select id="jumpRange">
    <option value="">--Select--</option>
    <option>0.0 - 1.5</option>
    <option>1.75 - 2.75</option>
    <option>3.0 - 4.0</option>
    <option>4.25 - 4.75</option>
    <option>5.0</option>
  </select>

  <label>Jump Sequence Description</label>
  <textarea id="jumpSequence" rows="3"></textarea>

  <label>Any Legality Rulings from Bill Ahern?</label>
  <select id="legalityRulings">
    <option value="">--Select--</option>
    <option>Yes</option>
    <option>No</option>
  </select>

  <!-- Hidden Google Form fields -->
  <textarea name="entry.853885754" id="gStuntSkills" style="display:none;"></textarea>
  <textarea name="entry.839382260" id="gStuntRange" style="display:none;"></textarea>
  <input type="hidden" name="entry.1305398481" id="gSchoolName">
  <input type="hidden" name="entry.1115196285" id="gTeamLevel">
  <input type="hidden" name="entry.1591826976" id="gNumAthletes">
  <input type="hidden" name="entry.213144247" id="gLocation">
  <input type="hidden" name="entry.350592538" id="gDate">
  <input type="hidden" name="entry.1261324678" id="gPyramidRange">
  <input type="hidden" name="entry.1334475235" id="gPyramidSkills">
  <input type="hidden" name="entry.1257575335" id="gTumblingRange">
  <input type="hidden" name="entry.1061923490" id="gTeamSync">
  <input type="hidden" name="entry.366964955" id="gAdditionalTumbling">
  <input type="hidden" name="entry.1517156909" id="gJumpRange">
  <input type="hidden" name="entry.1736401588" id="gJumpSequence">
  <input type="hidden" name="entry.815911308" id="gLegalityRulings">

  <div style="text-align: center; margin-top: 30px;">
    <button type="button" id="saveBtn" style="padding: 12px 20px; font-size: 16px;">Save & Submit</button>
  </div>

</form>

<pre id="output"></pre>
<iframe name="hidden_iframe" style="display:none;"></iframe>

<script>
const regions = [
  { id: 'i1', skill: 'Connected Inversions - Prep Level and Below to Below Prep', category: 'Inversion', difficulty: 'Beginner'},
  { id: 'i2', skill: 'Below Prep Level Inversions to Ground', category: 'Inversion', difficulty: 'Beginner' },
  { id: 'i3', skill: 'Released Inversion Prep Level or Below to Below Prep', category: 'Inversion', difficulty: 'Beginner' },
  { id: 'i4', skill: 'Connected Inversions - Prep Level and Below to Prep', category: 'Inversion', difficulty: 'Intermediate' },
  { id: 'r1', skill: 'Release to Below Prep', category: 'Release', difficulty: 'Beginner' },
  { id: 'r2', skill: 'Horizontal Releases to Below Prep', category: 'Release', difficulty: 'Beginner' },
  { id: 'r3', skill: 'Extended Release to Below Prep', category: 'Release', difficulty: 'Beginner' },
  { id: 't1', skill: '1/4 or 1/2 Up to Prep Level', category: 'Twisting', difficulty: 'Beginner' },
  { id: 't2', skill: '1/4 Up to Extended', category: 'Twisting', difficulty: 'Beginner' },
  { id: 't3', skill: '1/4 or 1/2 Twisting Transitions', category: 'Twisting', difficulty: 'Beginner' },
  { id: 'c1', skill: 'Single Base at Prep Level', category: 'Coed', difficulty: 'Beginner' },
  { id: 'c2', skill: 'Assisted Coed Skills to Prep', category: 'Coed', difficulty: 'Beginner' },
  { id: 'c3', skill: 'Assisted Walk-In/Toss to Chair', category: 'Coed', difficulty: 'Beginner' },
  { id: 'o1', skill: 'Prep Level and Below Stunts Not Previously Categorized', category: 'Toss', difficulty: 'Beginner' },
  { id: 'o2', skill: 'Straight Ride or Pretty Girl Tosses', category: 'Toss', difficulty: 'Beginner' },
  { id: 'o3', skill: 'Single Skill Tosses', category: 'Toss', difficulty: 'Beginner' },
  { id: 'h1', skill: 'TEST', category: 'Inversion', difficulty: 'Advanced' },
  { id: 'h2', skill: 'TEST', category: 'Release', difficulty: 'Elite' },
  { id: 'h3', skill: 'TEST', category: 'Twisting', difficulty: 'Super Elite' }
];

const wrapper = document.querySelector('.wrapper');
const skillCountsContainer = document.getElementById('skillCounts');

// Click on rubric image to add skill row
wrapper.addEventListener('click', e => {
  const rect = wrapper.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;

  for (let r of regions) {
    const box = document.getElementById(r.id);
    const left = parseFloat(box.style.left);
    const top = parseFloat(box.style.top);
    const width = parseFloat(box.style.width);
    const height = parseFloat(box.style.height);

    if (x >= left && x <= left + width && y >= top && y <= top + height) {
      const skillId = 'count_' + r.id;

      // flash highlight
      box.style.display = "block";
      setTimeout(() => box.style.display = "none", 150);

      // Create new row
      const row = document.createElement('tr');
      row.id = skillId + '_' + Date.now();
      row.draggable = true; // <-- Make row draggable
      row.innerHTML = `
        <td class="drag-handle">‚áÖ</td>
        <td>${r.skill}</td>
		 <td>${r.difficulty}</td>
        <td><input type="number" id="${skillId}" min="0" value="0"></td>
        <td class="delete-btn">üóëÔ∏è</td>
      `;
      skillCountsContainer.appendChild(row);

      // Delete row
      row.querySelector('.delete-btn').addEventListener('click', () => {
        skillCountsContainer.removeChild(row);
      });

      break;
    }
  }
});

// Drag and drop functionality
let draggedRow = null;

skillCountsContainer.addEventListener('dragstart', e => {
  draggedRow = e.target.closest('tr');
  if (draggedRow) e.dataTransfer.effectAllowed = 'move';
});

skillCountsContainer.addEventListener('dragover', e => {
  e.preventDefault();
  const targetRow = e.target.closest('tr');
  if (!targetRow || targetRow === draggedRow) return;

  const rect = targetRow.getBoundingClientRect();
  const next = (e.clientY - rect.top) > rect.height / 2;
  skillCountsContainer.insertBefore(draggedRow, next ? targetRow.nextSibling : targetRow);
});

skillCountsContainer.addEventListener('drop', e => {
  e.preventDefault();
  draggedRow = null;
});


function runChecker() {
  const numAthletes = parseInt(document.getElementById('numAthletes').value) || 0;
  const majorityStunt = numAthletes <= 15 ? 2 : 3;

  const rows = document.querySelectorAll('#skillCounts tr');
  let majoritySkills = [];
  let outputText = 'Selected VHSL Stunt Rubric Skills:\n\n';

  // Step 1: Reset table coloring
  rows.forEach((row, idx) => {
    // skip header if (idx === 0) return; 
    row.classList.remove('majority', 'non-majority');
  });

  // Step 2: Label Non-Majority Skills and gather majority skills
  rows.forEach((row, idx) => {
    // skip header if (idx === 0) return; 
    const skill = row.cells[1].textContent;
    const difficulty = row.cells[2].textContent;
    const count = parseInt(row.cells[3].querySelector('input').value) || 0;

    if (count >= majorityStunt) {
      majoritySkills.push({ skill, difficulty });
      row.classList.add('majority');
      outputText += `${count} ‚Äî ${skill} [${difficulty}]\n`;
    } else {
      row.classList.add('non-majority');
      outputText += `${count} ‚Äî ${skill} [${difficulty}] (Non Majority)\n`;
    }
  });

  // Step 3: Define difficulty levels for sorting
  const difficultyLevels = {
    'Beginner': 1,
    'Intermediate': 2,
    'Advanced': 3,
    'Elite': 4,
    'Super Elite': 5
  };

  // Step 4: Count how many majority skills are at each difficulty
  const difficultyCount = {};
  majoritySkills.forEach(s => {
    difficultyCount[s.difficulty] = (difficultyCount[s.difficulty] || 0) + 1;
  });

  // Step 5: Sort difficulties from highest to lowest
  const sortedDifficulties = Object.keys(difficultyLevels).sort(
    (a, b) => difficultyLevels[b] - difficultyLevels[a]
  );

  // Step 6: Determine overall difficulty based on cumulative majority
  let overallDifficulty = null;
  const startingIndex = sortedDifficulties.findIndex(d => difficultyCount[d] >= 1);

  if (startingIndex !== -1) {
    let cumulative = 0;
    // Step down from highest to lowest, adding cumulative majority skills
    for (let i = startingIndex; i < sortedDifficulties.length; i++) {
      cumulative += (difficultyCount[sortedDifficulties[i]] || 0);
      if (cumulative >= 2) {
        overallDifficulty = sortedDifficulties[i]; // first range that meets cumulative majority
        break;
      }
    }
  }

  // Step 7: Output results
  outputText += `\nRequired Number of Groups for Majority: ${majorityStunt}`;
  outputText += `\nOverall Difficulty Range: ${overallDifficulty || 'Selected skills do not meet rubric requirements for majority'}`;

  document.getElementById('output').textContent = outputText;
  document.getElementById('gStuntRange').value = overallDifficulty || '';
}



// Save & submit
document.getElementById('saveBtn').addEventListener('click', () => {
  let out = 'Selected VHSL Stunt Rubric Skills:\n\n';
  const rows = skillCountsContainer.querySelectorAll('tr');
  if (rows.length === 0) out += '(None selected)';
  else rows.forEach(row => {
    const skill = row.cells[1].textContent;
    const difficulty = row.cells[2].textContent;
    const countInput = row.cells[3].querySelector('input');
    const count = countInput ? countInput.value : 0;
    out += `${count} ‚Äî ${skill} [${difficulty}]\n`;
  });
  document.getElementById('output').textContent = out;

  // Populate hidden fields
  document.getElementById('gStuntSkills').value = out;
  document.getElementById('gSchoolName').value = document.getElementById('schoolName').value;
  document.getElementById('gTeamLevel').value = document.getElementById('teamLevel').value;
  document.getElementById('gNumAthletes').value = document.getElementById('numAthletes').value;
  document.getElementById('gLocation').value = document.getElementById('competitionLocation').value;
  document.getElementById('gDate').value = document.getElementById('competitionDate').value;
  document.getElementById('gStuntRange').value = document.getElementById('stuntRange').value;
  document.getElementById('gPyramidRange').value = document.getElementById('pyramidRange').value;
  document.getElementById('gPyramidSkills').value = document.getElementById('pyramidSkills').value;
  document.getElementById('gTumblingRange').value = document.getElementById('tumblingRange').value;
  document.getElementById('gTeamSync').value = document.getElementById('teamSync').value;
  document.getElementById('gAdditionalTumbling').value = document.getElementById('additionalTumbling').value;
  document.getElementById('gJumpRange').value = document.getElementById('jumpRange').value;
  document.getElementById('gJumpSequence').value = document.getElementById('jumpSequence').value;
  document.getElementById('gLegalityRulings').value = document.getElementById('legalityRulings').value;

  // Submit form
  document.getElementById('fullForm').submit();
});
</script>


</body>
</html>









